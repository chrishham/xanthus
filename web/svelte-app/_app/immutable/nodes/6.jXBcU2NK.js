import{_ as t,s as e,c as a}from"../chunks/DIuwMBRZ.js";import{p as s,o as n,l as i,a as r,i as l,f as o,h as d,c,e as m,g as u,s as f,$ as v,t as p,j as g,k as x,m as h,n as y,q as w,r as b,u as C,v as $,x as S,y as k,z as B,A as L,B as T,C as D,D as _,F as M,G as j}from"../chunks/D4QSdlkG.js";import{s as R,a as z,d as A,b as E,c as V,f as P}from"../chunks/CzjcLTVz.js";import{C as X}from"../chunks/DKuP6dix.js";import{B as O}from"../chunks/eOFwP-ou.js";var F=o('<div class="bg-blue-50 border border-blue-200 rounded-md p-4"><div class="flex"><div class="flex-shrink-0"><svg class="h-5 w-5 text-blue-400" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg></div> <div class="ml-3"><h3 class="text-sm font-medium text-blue-800">Domain Management</h3> <div class="mt-2 text-sm text-blue-700"><p>Below are all domains registered in your Cloudflare account. Domains marked as "Managed by Xanthus" are configured for K3s deployment.</p></div></div></div></div>'),H=o('<div class="mb-6"><!></div>'),K=o('<div class="bg-red-50 border border-red-200 rounded-md p-4"><div class="flex"><div class="flex-shrink-0"><svg class="h-5 w-5 text-red-400" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg></div> <div class="ml-3"><h3 class="text-sm font-medium text-red-800">Error</h3> <p class="mt-1 text-sm text-red-700"> </p></div></div></div>'),N=o('<div class="mb-6"><!></div>'),I=o('<div class="text-center py-12"><div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div> <p class="mt-2 text-sm text-gray-600">Loading domains...</p></div>'),U=o('<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"><svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg> Managed by Xanthus</span>'),q=o('<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-600">Not Managed</span>'),Y=o('<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800"><svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg> Paused</span>'),G=o("<!> <!>",1),W=o('<div class="flex items-center justify-between p-6"><div class="flex-1"><div class="flex items-center space-x-3"><h3 class="text-lg font-semibold text-gray-900"> </h3> <span><svg class="w-2 h-2 mr-1 fill-current" viewBox="0 0 8 8"><circle cx="4" cy="4" r="3"></circle></svg> </span> <!> <!></div> <div class="mt-2 text-sm text-gray-600"><p> </p> <p> </p></div></div> <div class="flex items-center space-x-2"><!></div></div>'),J=o('<div class="grid grid-cols-1 gap-4"></div>'),Q=o('<div class="text-center py-12"><svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <h3 class="mt-2 text-sm font-medium text-gray-900">No domains found</h3> <p class="mt-1 text-sm text-gray-500">No domains are registered in your Cloudflare account.</p> <div class="mt-6"><a href="https://dash.cloudflare.com/" target="_blank" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Add Domain to Cloudflare</a></div></div>'),Z=o('<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><div class="mb-8"><h2 class="text-3xl font-bold text-gray-900 mb-2">DNS Configuration</h2> <p class="text-gray-600">Manage your Cloudflare domains and SSL certificates</p></div> <div class="mb-6"><!></div> <!> <!> <!> <!> <!></div>');function tt(o,tt){s(tt,!1);const[et,at]=f(),st=()=>C(V,"$dnsStore",et),nt=()=>C(P,"$filteredDomains",et),it=b(),rt=b(),lt=b();async function ot(){R(!0),z(null);try{const t=await A.fetchDomains();E(t)}catch(t){z("Failed to load domains")}}n(async()=>{await ot()}),i(()=>(x(it),x(rt),st()),()=>{var t;t=st(),w(it,t.loading),w(rt,t.error)}),i(()=>nt(),()=>{w(lt,nt())}),r(),l();var dt=Z();d(t=>{v.title="DNS Configuration - Xanthus"});var ct=y(h(dt),2),mt=h(ct);O(mt,{variant:"primary",size:"sm",get disabled(){return x(it)},$$events:{click:ot},children:(t,e)=>{$();var a=p();g(()=>S(a,x(it)?"Refreshing...":"Refresh Domains")),m(t,a)},$$slots:{default:!0}}),k(ct);var ut=y(ct,2),ft=t=>{var e=H(),a=h(e);X(a,{children:(t,e)=>{var a=F();m(t,a)},$$slots:{default:!0}}),k(e),m(t,e)};c(ut,t=>{x(lt),B(()=>x(lt).length>0)&&t(ft)});var vt=y(ut,2),pt=t=>{var e=N(),a=h(e);X(a,{children:(t,e)=>{var a=K(),s=h(a),n=y(h(s),2),i=y(h(n),2),r=h(i,!0);k(i),k(n),k(s),k(a),g(()=>S(r,x(rt))),m(t,a)},$$slots:{default:!0}}),k(e),m(t,e)};c(vt,t=>{x(rt)&&t(pt)});var gt=y(vt,2),xt=t=>{var e=I();m(t,e)};c(gt,t=>{x(it)&&t(xt)});var ht=y(gt,2),yt=s=>{var n=J();L(n,5,()=>x(lt),j,(s,n)=>{X(s,{children:(s,i)=>{var r=W(),l=h(r),o=h(l),d=h(o),u=h(d,!0);k(d);var f=y(d,2),v=y(h(f));k(f);var w=y(f,2),b=t=>{var e=U();m(t,e)},C=t=>{var e=q();m(t,e)};c(w,t=>{x(n),B(()=>x(n).managed)?t(b):t(C,!1)});var L=y(w,2),j=t=>{var e=Y();m(t,e)};c(L,t=>{x(n),B(()=>x(n).paused)&&t(j)}),k(o);var R=y(o,2),z=h(R),E=h(z);k(z);var V=y(z,2),P=h(V);k(V),k(R),k(l);var X=y(l,2),F=h(X),H=s=>{var i=G(),r=M(i);O(r,{variant:"secondary",size:"sm",$$events:{click:()=>async function(e){try{const{default:a}=await t(async()=>{const{default:t}=await import("../chunks/CT2pLRIc.js");return{default:t}},[],import.meta.url);await a.fire({title:`Configuration for ${e.name}`,html:'\n\t\t\t\t\t<div class="text-left">\n\t\t\t\t\t\t<div class="space-y-3">\n\t\t\t\t\t\t\t<div class="flex justify-between">\n\t\t\t\t\t\t\t\t<span class="font-medium">SSL Mode:</span>\n\t\t\t\t\t\t\t\t<span class="text-green-600">Full (strict)</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="flex justify-between">\n\t\t\t\t\t\t\t\t<span class="font-medium">Origin Certificate:</span>\n\t\t\t\t\t\t\t\t<span class="text-green-600">✓ Created</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="flex justify-between">\n\t\t\t\t\t\t\t\t<span class="font-medium">Always Use HTTPS:</span>\n\t\t\t\t\t\t\t\t<span class="text-green-600">✓ Enabled</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="flex justify-between">\n\t\t\t\t\t\t\t\t<span class="font-medium">Page Rule:</span>\n\t\t\t\t\t\t\t\t<span class="text-green-600">✓ www redirect</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="flex justify-between">\n\t\t\t\t\t\t\t\t<span class="font-medium">Certificates:</span>\n\t\t\t\t\t\t\t\t<span class="text-green-600">✓ Stored in KV</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="mt-4 p-3 bg-blue-50 rounded-md">\n\t\t\t\t\t\t\t<p class="text-sm text-blue-800">\n\t\t\t\t\t\t\t\tSSL certificates are ready for K8s deployment. They will be automatically applied when you deploy your application.\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t',icon:"info",confirmButtonText:"Close",confirmButtonColor:"#3b82f6"})}catch(a){console.error("Error viewing configuration:",a)}}(x(n))},children:(t,e)=>{$();var a=p("View Config");m(t,a)},$$slots:{default:!0}});var l=y(r,2);O(l,{variant:"danger",size:"sm",$$events:{click:()=>async function(s){try{const{default:n}=await t(async()=>{const{default:t}=await import("../chunks/CT2pLRIc.js");return{default:t}},[],import.meta.url);(await n.fire({title:`Remove ${s.name} from Xanthus?`,html:'\n\t\t\t\t\t<div class="text-left">\n\t\t\t\t\t\t<p class="mb-4">This will completely revert all Cloudflare changes made by Xanthus:</p>\n\t\t\t\t\t\t<ul class="list-disc list-inside space-y-2 text-sm text-red-600">\n\t\t\t\t\t\t\t<li>Delete origin server certificate</li>\n\t\t\t\t\t\t\t<li>Remove www redirect page rules</li>\n\t\t\t\t\t\t\t<li>Reset SSL mode to Flexible</li>\n\t\t\t\t\t\t\t<li>Disable Always Use HTTPS</li>\n\t\t\t\t\t\t\t<li>Remove configuration from Xanthus storage</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t<div class="mt-4 p-3 bg-amber-50 border border-amber-200 rounded-md">\n\t\t\t\t\t\t\t<p class="text-sm text-amber-800">\n\t\t\t\t\t\t\t\t<strong>Warning:</strong> Your domain will return to its original Cloudflare state before Xanthus management.\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t',icon:"warning",showCancelButton:!0,confirmButtonText:"Remove & Revert All",cancelButtonText:"Cancel",confirmButtonColor:"#ef4444",showLoaderOnConfirm:!0,preConfirm:async()=>{try{return e("Removing domain...","Please wait while we revert all changes"),await A.removeDomain(s.name)}catch(t){n.showValidationMessage("Error: "+t.message)}finally{a()}}})).isConfirmed&&(await n.fire({title:"Successfully Removed!",html:`\n\t\t\t\t\t\t<div class="text-center">\n\t\t\t\t\t\t\t<p class="mb-3">All Cloudflare changes have been reverted for <strong>${s.name}</strong></p>\n\t\t\t\t\t\t\t<p class="text-sm text-gray-600">Your domain has been restored to its original Cloudflare configuration.</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`,icon:"success",confirmButtonColor:"#10b981"}),await ot())}catch(n){console.error("Error removing domain:",n)}}(x(n))},children:(t,e)=>{$();var a=p("Remove");m(t,a)},$$slots:{default:!0}}),m(s,i)},K=s=>{O(s,{variant:"primary",size:"sm",$$events:{click:()=>async function(s){try{const{default:n}=await t(async()=>{const{default:t}=await import("../chunks/CT2pLRIc.js");return{default:t}},[],import.meta.url);(await n.fire({title:`Configure SSL for ${s.name}`,html:'\n\t\t\t\t\t<div class="text-left">\n\t\t\t\t\t\t<p class="mb-4">This will automatically configure:</p>\n\t\t\t\t\t\t<ul class="list-disc list-inside space-y-2 text-sm">\n\t\t\t\t\t\t\t<li>SSL/TLS mode to Full (strict)</li>\n\t\t\t\t\t\t\t<li>Create Origin Server Certificate</li>\n\t\t\t\t\t\t\t<li>Append Cloudflare Root CA</li>\n\t\t\t\t\t\t\t<li>Enable Always Use HTTPS</li>\n\t\t\t\t\t\t\t<li>Create www redirect page rule</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t<p class="mt-4 text-sm text-gray-600">The certificates will be stored in Cloudflare KV for K8s deployment.</p>\n\t\t\t\t\t</div>\n\t\t\t\t',icon:"question",showCancelButton:!0,confirmButtonText:"Configure SSL",cancelButtonText:"Cancel",confirmButtonColor:"#3b82f6",showLoaderOnConfirm:!0,preConfirm:async()=>{try{return e("Configuring SSL...","Please wait while we configure SSL for your domain"),await A.configureDomain(s.name)}catch(t){n.showValidationMessage("Error: "+t.message)}finally{a()}}})).isConfirmed&&(await n.fire({title:"Success!",text:`SSL configuration completed for ${s.name}`,icon:"success",confirmButtonColor:"#10b981"}),await ot())}catch(n){console.error("Error configuring domain:",n)}}(x(n))},children:(t,e)=>{$();var a=p("Add to Xanthus");m(t,a)},$$slots:{default:!0}})};c(F,t=>{x(n),B(()=>x(n).managed)?t(H):t(K,!1)}),k(X),k(r),g((t,e,a,s)=>{S(u,(x(n),B(()=>x(n).name))),_(f,1,`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t??""}`),S(v,` ${e??""}`),S(E,`Type: ${x(n),B(()=>x(n).type)??""} | ID: ${x(n),B(()=>x(n).id)??""}`),S(P,`Created: ${a??""} | Modified: ${s??""}`)},[()=>(x(n),B(()=>getStatusBadgeClass(x(n).status))),()=>(x(n),B(()=>x(n).status.charAt(0).toUpperCase()+x(n).status.slice(1))),()=>(D(A),x(n),B(()=>A.formatDate(x(n).created_on))),()=>(D(A),x(n),B(()=>A.formatDate(x(n).modified_on)))],T),m(s,r)},$$slots:{default:!0}})}),k(n),m(s,n)};c(ht,t=>{x(it),x(lt),B(()=>!x(it)&&x(lt).length>0)&&t(yt)});var wt=y(ht,2),bt=t=>{var e=Q();m(t,e)};c(wt,t=>{x(it),x(lt),x(rt),B(()=>!x(it)&&0===x(lt).length&&!x(rt))&&t(bt)}),k(dt),m(o,dt),u(),at()}export{tt as component};
