import{p as e,a9 as a,l as s,a as t,i as r,K as i,P as o,F as n,c as l,e as d,g as c,s as p,aa as v,q as u,r as g,u as m,k as f,f as h,m as y,y as x,n as b,B as w,v as $,t as k,z as C,j as A,x as j,S as P,ab as M,ac as _,J as S,o as D,_ as R,A as z,D as V,G as B,C as E,I as L,h as q,$ as F}from"../chunks/ChrfcdU-.js";import{a as H,h as N,b as O,c as T,d as U,p as G,s as Y,e as I,f as K}from"../chunks/BlnJ1S3g.js";import{a as J,s as Q,f as X,g as W}from"../chunks/DPUnOLHg.js";import{B as Z}from"../chunks/B7eHPThx.js";import{C as ee}from"../chunks/01YQGtXD.js";import{I as ae,S as se}from"../chunks/CgyAwLAs.js";import{L as te}from"../chunks/CLzwXi1W.js";const re=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});var ie=h('<div class="text-2xl mr-3"> </div> <div><h3 id="deployment-modal-title" class="text-lg font-medium text-gray-900"> </h3> <p class="text-sm text-gray-600"> </p></div>',1),oe=h('<div class="bg-gray-50 border border-gray-200 rounded-lg p-4"><div class="flex items-center mb-2"><svg class="w-4 h-4 mr-1 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.102m0 0l4-4a4 4 0 105.656-5.656l-1.102 1.102m-2.828 2.828l4 4"></path></svg> <span class="text-sm font-medium text-gray-700">Application URL</span></div> <p class="text-lg font-mono bg-white px-3 py-2 rounded border"> </p></div>'),ne=h('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" role="dialog" aria-modal="true" aria-labelledby="deployment-modal-title" tabindex="-1"><div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto" role="document"><div class="p-6 border-b border-gray-200"><div class="flex items-center justify-between"><div class="flex items-center"><!></div> <button class="text-gray-400 hover:text-gray-600" aria-label="Close deployment modal" title="Close deployment modal"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div></div> <div class="p-6 space-y-6"><div><!></div> <div class="bg-blue-50 border border-blue-200 rounded-lg p-4"><div class="flex items-center mb-2"><svg class="w-4 h-4 mr-1 text-blue-700" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"></path></svg> <span class="text-sm font-medium text-blue-900">VPS Server *</span></div> <!></div> <div class="bg-green-50 border border-green-200 rounded-lg p-4"><div class="flex items-center mb-2"><svg class="w-4 h-4 mr-1 text-green-700" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9v-9m0-9v9"></path></svg> <span class="text-sm font-medium text-green-900">Domain *</span></div> <!></div> <div><!></div> <div><!></div> <div class="bg-purple-50 border border-purple-200 rounded-lg p-4"><div class="flex items-center mb-2"><svg class="w-4 h-4 mr-1 text-purple-700" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a2 2 0 012-2z"></path></svg> <span class="text-sm font-medium text-purple-900">Version</span></div> <!></div> <!></div> <div class="px-6 py-4 bg-gray-50 border-t border-gray-200 rounded-b-lg"><div class="flex justify-end space-x-3"><!> <!></div></div></div></div>');function le(h,P){e(P,!1);const[M,_]=p(),S=()=>m(H,"$applicationStore",M),D=g(),R=g(),z=g(),V=g(),B=g(),E=g(),L=g(),q=g(),F=g(),O=g(),T=a();let U=g(""),G=g(""),Y=g(""),I=g(""),K=g(""),ee=g(""),te=g([]),re=g(!1);function le(){N()}async function de(){if(f(L)&&f(V)){Q(!0),X("Deploying Application"),W(`Deploying ${f(V).name} to your VPS...`);try{const e={app_type:f(V).id,name:f(U).trim(),vps_id:f(G),domain:f(Y),subdomain:f(I).trim(),description:f(K).trim(),version:f(ee)},a=await J.post("/applications/deploy",e);if(!a.success)throw new Error(a.error||"Deployment failed");T("deployment-success",a),le(),console.log("Application deployed successfully")}catch(e){console.error("Deployment error:",e),T("deployment-error",e)}finally{Q(!1)}}}s(()=>(f(D),S()),()=>{var e;e=S(),u(D,e.modals)}),s(()=>f(D),()=>{u(R,f(D).deployment)}),s(()=>f(R),()=>{u(z,f(R).show)}),s(()=>f(R),()=>{u(V,f(R).predefinedApp)}),s(()=>f(R),()=>{u(B,f(R).domains)}),s(()=>f(R),()=>{u(E,f(R).servers)}),s(()=>(f(U),f(G),f(Y),f(I)),()=>{u(L,""!==f(U).trim()&&""!==f(G)&&""!==f(Y)&&""!==f(I).trim())}),s(()=>(f(z),f(V)),()=>{f(z)&&f(V)&&(f(V)&&(u(U,`my-${f(V).id}`),u(G,""),u(Y,""),u(I,f(V).id),u(K,`My ${f(V).name} instance`),u(ee,f(V).version),u(te,[])),async function(){if(f(V)){u(re,!0);try{const e=await J.get(`/applications/versions/${f(V).id}`);if(e.success&&e.versions&&(u(te,e.versions),!f(ee)&&f(te).length>0)){const e=f(te).find(e=>e.version===f(V).version)||f(te)[0];u(ee,e.version)}}catch(e){console.warn("Failed to fetch versions:",e),u(te,[{version:f(V).version,is_latest:!1,is_stable:!0}]),u(ee,f(V).version)}finally{u(re,!1)}}}())}),s(()=>f(B),()=>{u(q,f(B).map(e=>({value:e.name,label:e.name})))}),s(()=>f(E),()=>{u(F,f(E).map(e=>({value:e.id,label:`${e.name} (${e.public_net.ipv4.ip})`})))}),s(()=>f(te),()=>{u(O,f(te).map(e=>({value:e.version,label:`${e.version}${e.is_latest?" (Latest)":""}${e.is_stable?"":" (Pre-release)"}`})))}),t(),r();var ce=i();o("keydown",v,function(e){"Escape"===e.key&&le()});var pe=n(ce),ve=e=>{var a=ne(),s=y(a),t=y(s),r=y(t),i=y(r),c=y(i),p=e=>{var a=ie(),s=n(a),t=y(s,!0);x(s);var r=b(s,2),i=y(r),o=y(i);x(i);var l=b(i,2),c=y(l,!0);x(l),x(r),A(()=>{j(t,(f(V),C(()=>f(V).icon))),j(o,`Deploy ${f(V),C(()=>f(V).name)??""}`),j(c,(f(V),C(()=>f(V).description)))}),d(e,a)};l(c,e=>{f(V)&&e(p)}),x(i);var v=b(i,2);x(r),x(t);var g=b(t,2),m=y(g),h=y(m);const P=w(()=>(f(V),C(()=>f(V)?.id||"app")));ae(h,{label:"Application Name",get placeholder(){return`my-${f(P)??""}`},help:"A friendly name for your application instance",required:!0,get value(){return f(U)},set value(e){u(U,e)},$$legacy:!0}),x(m);var M=b(m,2),_=b(y(M),2);se(_,{get options(){return f(F)},placeholder:"👆 Click to choose a VPS server",help:"Select the server where your application will be deployed",class:"border-blue-300 focus:border-blue-500 focus:ring-blue-500",required:!0,get value(){return f(G)},set value(e){u(G,e)},$$legacy:!0}),x(M);var S=b(M,2),D=b(y(S),2);se(D,{get options(){return f(q)},placeholder:"👆 Click to select a domain",help:"Choose the domain for your application",class:"border-green-300 focus:border-green-500 focus:ring-green-500",required:!0,get value(){return f(Y)},set value(e){u(Y,e)},$$legacy:!0}),x(S);var R=b(S,2),z=y(R);const B=w(()=>(f(V),C(()=>f(V)?.id||"app")));ae(z,{label:"Subdomain",get placeholder(){return f(B)},help:"Your app will be available at subdomain.domain.com",required:!0,get value(){return f(I)},set value(e){u(I,e)},$$legacy:!0}),x(R);var E=b(R,2),H=y(E);const N=w(()=>(f(V),C(()=>f(V)?.name||"application")));ae(H,{label:"Description (optional)",get placeholder(){return`My ${f(N)??""} instance`},help:"Optional description for this application instance",get value(){return f(K)},set value(e){u(K,e)},$$legacy:!0}),x(E);var T=b(E,2),J=b(y(T),2);se(J,{get options(){return f(O)},placeholder:"Select version...",help:"Choose the application version to deploy",get loading(){return f(re)},class:"border-purple-300 focus:border-purple-500 focus:ring-purple-500",get value(){return f(ee)},set value(e){u(ee,e)},$$legacy:!0}),x(T);var Q=b(T,2),X=e=>{var a=oe(),s=b(y(a),2),t=y(s);x(s),x(a),A(()=>j(t,`https://${f(I)??""}.${f(Y)??""}`)),d(e,a)};l(Q,e=>{f(Y)&&f(I)&&e(X)}),x(g);var W=b(g,2),te=y(W),ce=y(te);Z(ce,{variant:"outline",$$events:{click:le},children:(e,a)=>{$();var s=k("Cancel");d(e,s)},$$slots:{default:!0}});var pe=b(ce,2);const ve=w(()=>!f(L));Z(pe,{variant:"primary",get disabled(){return f(ve)},class:"bg-purple-600 hover:bg-purple-700",$$events:{click:de},children:(e,a)=>{$();var s=k("Deploy Application");d(e,s)},$$slots:{default:!0}}),x(te),x(W),x(s),x(a),o("click",v,le),o("click",a,le),o("keydown",a,e=>"Escape"===e.key&&le()),d(e,a)};l(pe,e=>{f(z)&&e(ve)}),d(h,ce),c(),_()}var de=h('<div class="flex items-center justify-center py-8"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div> <span class="ml-2 text-gray-600">Loading password...</span></div>'),ce=M('<svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg> ',1),pe=h('<div class="p-4 bg-blue-50 border border-blue-200 rounded-lg"><h4 class="font-medium text-blue-900 mb-2">🔐 Password</h4> <div class="flex items-center space-x-2"><input type="text" class="flex-1 px-3 py-2 border border-blue-300 rounded font-mono text-sm bg-white" readonly=""/> <!></div> <p class="text-sm text-blue-700 mt-2"> </p></div> <div class="p-4 bg-green-50 border border-green-200 rounded-lg"><h4 class="font-medium text-green-900 mb-2">🔗 Quick Access</h4> <div class="text-center"><!></div></div>',1),ve=h('<div class="space-y-6"><p class="text-gray-700">Current password for <strong> </strong>:</p> <!></div>'),ue=h('<div class="space-y-6"><p class="text-gray-700">Change the password for <strong> </strong>:</p> <div class="p-3 bg-yellow-50 border border-yellow-200 rounded-md"><div class="flex items-center"><svg class="w-5 h-5 text-yellow-600 mr-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg> <span class="text-sm text-yellow-800"> </span></div></div> <div><!></div></div>'),ge=h('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" role="dialog" aria-modal="true" aria-labelledby="modal-title" tabindex="-1"><div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto" role="document"><div class="p-6 border-b border-gray-200"><div class="flex items-center justify-between"><div class="flex items-center"><div class="text-2xl mr-3">🔐</div> <div><h3 id="modal-title" class="text-lg font-medium text-gray-900"> </h3> <p class="text-sm text-gray-600"> </p></div></div> <button class="text-gray-400 hover:text-gray-600" aria-label="Close modal" title="Close modal"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div></div> <div class="p-6"><!></div> <div class="px-6 py-4 bg-gray-50 border-t border-gray-200 rounded-b-lg"><div class="flex justify-end space-x-3"><!> <!></div></div></div></div>');function me(h,M){e(M,!1);const[S,D]=p(),R=()=>m(H,"$applicationStore",S),z=g(),V=g(),B=g(),E=g(),L=g(),q=g(),F=g(),N=g(),T=g(),U=a();let G=g(""),Y=g(""),I=g(!1),K=g("Copy");async function ee(){if(f(E)&&f(Y).trim()){Q(!0),X("Changing Password"),W(`Updating password for "${f(E).name}"...`);try{const e=await J.post(`/applications/${f(E).id}/password`,{password:f(Y).trim()});if(!e.success)throw new Error(e.error||"Failed to change password");U("password-changed",{app:f(E),newPassword:f(Y).trim()}),te()}catch(e){console.error("Password change error:",e),U("password-error",e)}finally{Q(!1)}}}async function se(){if(f(G))try{await navigator.clipboard.writeText(f(G)),u(K,"Copied!"),setTimeout(()=>{u(K,"Copy")},2e3)}catch(e){console.error("Failed to copy password:",e)}}function te(){O()}function re(){f(E)?.url&&window.open(f(E).url,"_blank")}s(()=>(f(z),R()),()=>{var e;e=R(),u(z,e.modals)}),s(()=>f(z),()=>{u(V,f(z).password)}),s(()=>f(V),()=>{u(B,f(V).show)}),s(()=>f(V),()=>{u(E,f(V).app)}),s(()=>f(V),()=>{u(L,f(V).mode)}),s(()=>f(E),()=>{u(q,"argocd"===f(E)?.app_type?"ArgoCD":"Code-Server")}),s(()=>f(E),()=>{u(F,"argocd"===f(E)?.app_type?"You can use this password to access your ArgoCD admin interface":"You can use this password to access your code-server instance")}),s(()=>f(E),()=>{u(N,"argocd"===f(E)?.app_type?"Open ArgoCD":"Open Code-Server")}),s(()=>f(E),()=>{u(T,"argocd"===f(E)?.app_type?"This will restart your ArgoCD instance":"This will restart your code-server instance")}),s(()=>(f(B),f(E),f(L)),()=>{f(B)&&f(E)&&(u(G,""),u(Y,""),u(I,!1),u(K,"Copy"),"view"===f(L)&&async function(){if(f(E)){u(I,!0);try{const e=await J.get(`/applications/${f(E).id}/password`);if(!e.password)throw new Error(e.error||"Failed to retrieve password");u(G,e.password)}catch(e){console.error("Error retrieving password:",e),U("password-error",e)}finally{u(I,!1)}}}())}),t(),r();var ie=i();o("keydown",v,function(e){"Escape"===e.key?te():"Enter"===e.key&&"change"===f(L)&&f(Y).trim()&&ee()});var oe=n(ie),ne=e=>{var a=ge(),s=y(a),t=y(s),r=y(t),i=y(r),c=b(y(i),2),p=y(c),v=y(p,!0);x(p);var g=b(p,2),m=y(g,!0);x(g),x(c),x(i);var h=b(i,2);x(r),x(t);var M=b(t,2),S=y(M),D=e=>{var a=ve(),s=y(a),t=b(y(s)),r=y(t,!0);x(t),$(),x(s);var i=b(s,2),o=e=>{var a=de();d(e,a)},c=e=>{var a=pe(),s=n(a),t=b(y(s),2),r=y(t);P(r);var i=b(r,2);Z(i,{variant:"primary",size:"sm",class:"bg-blue-600 hover:bg-blue-700",$$events:{click:se},children:(e,a)=>{$();var s=k();A(()=>j(s,f(K))),d(e,s)},$$slots:{default:!0}}),x(t);var o=b(t,2),l=y(o);x(o),x(s);var c=b(s,2),p=b(y(c),2),v=y(p);Z(v,{variant:"primary",class:"bg-purple-600 hover:bg-purple-700 inline-flex items-center",$$events:{click:re},children:(e,a)=>{var s=ce(),t=b(n(s),1,!0);A(()=>j(t,f(N))),d(e,s)},$$slots:{default:!0}}),x(p),x(c),A(()=>{_(r,f(G)),j(l,`💡 ${f(F)??""}`)}),d(e,a)};l(i,e=>{f(I)?e(o):e(c,!1)}),x(a),A(()=>j(r,(f(E),C(()=>f(E).name)))),d(e,a)},R=e=>{var a=ue(),s=y(a),t=b(y(s)),r=y(t,!0);x(t),$(),x(s);var i=b(s,2),o=y(i),n=b(y(o),2),l=y(n,!0);x(n),x(o),x(i);var c=b(i,2),p=y(c);ae(p,{label:"New Password",type:"password",placeholder:"Enter new password...",help:"Choose a secure password for your application",required:!0,class:"font-mono",get value(){return f(Y)},set value(e){u(Y,e)},$$legacy:!0}),x(c),x(a),A(()=>{j(r,(f(E),C(()=>f(E).name))),j(l,f(T))}),d(e,a)};l(S,e=>{"view"===f(L)?e(D):e(R,!1)}),x(M);var z=b(M,2),V=y(z),B=y(V);Z(B,{variant:"outline",$$events:{click:te},children:(e,a)=>{$();var s=k();A(()=>j(s,"view"===f(L)?"Close":"Cancel")),d(e,s)},$$slots:{default:!0}});var H=b(B,2),O=e=>{const a=w(()=>(f(Y),C(()=>!f(Y).trim())));Z(e,{variant:"primary",get disabled(){return f(a)},class:"bg-green-600 hover:bg-green-700",$$events:{click:ee},children:(e,a)=>{$();var s=k("Change Password");d(e,s)},$$slots:{default:!0}})};l(H,e=>{"change"===f(L)&&e(O)}),x(V),x(z),x(s),x(a),A(()=>{j(v,"view"===f(L)?"Current Password":`Change ${f(q)} Password`),j(m,(f(E),C(()=>f(E).name)))}),o("click",h,te),o("click",a,te),o("keydown",a,e=>"Escape"===e.key&&te()),d(e,a)};l(oe,e=>{f(B)&&f(E)&&e(ne)}),d(h,ie),c(),D()}var fe=M('<svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg> Refresh',1),he=M('<svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg> ',1),ye=h('<span class="text-xs bg-gray-200 px-2 py-1 rounded"> </span>'),xe=h('<div class="text-sm text-gray-500 flex items-center space-x-2"><svg class="w-4 h-4 text-green-500 animate-pulse" fill="currentColor" viewBox="0 0 20 20"><circle cx="10" cy="10" r="3"></circle></svg> <span>Auto-refresh: every 30 seconds</span> <!></div>'),be=h('<div class="text-xs text-gray-600 flex items-center"><svg class="w-3 h-3 text-green-500 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> <span> </span></div>'),we=h('<div class="text-xs text-gray-400"><span> </span></div>'),$e=h('<div class="p-6 border-b border-gray-200"><div class="flex items-center"><div class="text-3xl mr-4"> </div> <div class="flex-1"><h4 class="text-lg font-medium text-gray-900"> </h4> <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800"> </span></div></div> <p class="text-sm text-gray-500 mt-3"> </p></div> <div class="p-6"><div class="space-y-3"><div class="flex items-center justify-between"><span class="text-sm text-gray-500">Version:</span> <span class="text-sm font-medium text-gray-900"> </span></div> <div><span class="text-sm text-gray-500 block mb-2">Features:</span> <div class="space-y-1"><!> <!></div></div></div></div> <div class="px-6 py-4 bg-gray-50 border-t border-gray-200 rounded-b-lg"><!></div>',1),ke=h('<div class="text-center py-12 bg-white rounded-lg shadow-md"><svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg> <h4 class="mt-2 text-lg font-medium text-gray-900">No applications deployed</h4> <p class="mt-1 text-gray-500">Deploy your first application from the catalog above.</p></div>'),Ce=h("<!> <!>",1),Ae=h('<div class="p-6 border-b border-gray-200"><div class="flex items-center justify-between"><div class="flex items-center"><div class="text-2xl mr-3"> </div> <div><h4 class="text-lg font-medium text-gray-900"> </h4> <span class="text-sm text-gray-500"> </span></div></div> <span> </span></div> <p class="text-sm text-gray-500 mt-2"> </p></div> <div class="p-6"><div class="space-y-3"><div class="flex items-center justify-between"><span class="text-sm text-gray-500">URL:</span> <a target="_blank" class="text-sm font-medium text-purple-600 hover:text-purple-800 truncate max-w-48"> </a></div> <div class="flex items-center justify-between"><span class="text-sm text-gray-500">VPS:</span> <span class="text-sm font-medium text-gray-900"> </span></div> <div class="flex items-center justify-between"><span class="text-sm text-gray-500">Version:</span> <span class="text-sm font-medium text-gray-900"> </span></div> <div class="flex items-center justify-between"><span class="text-sm text-gray-500">Created:</span> <span class="text-sm font-medium text-gray-900"> </span></div></div></div> <div class="px-6 py-4 bg-gray-50 border-t border-gray-200 rounded-b-lg"><div class="flex flex-wrap gap-2"><!> <!> <!> <!> <!> <!></div></div>',1),je=h('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>'),Pe=h('<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><div class="mb-8"><h2 class="text-3xl font-bold text-gray-900 mb-2">Applications</h2> <p class="text-gray-600">Deploy and manage curated applications on your VPS servers</p></div> <div class="flex justify-between items-center mb-6"><div class="flex space-x-3"><!> <!></div> <!></div> <div class="mb-12"><h3 class="text-xl font-semibold text-gray-900 mb-4">Available Applications</h3> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div></div> <div><h3 class="text-xl font-semibold text-gray-900 mb-4">Deployed Applications</h3> <!> <!></div></div> <!> <!>',1);function Me(a,i){e(i,!1);const[o,v]=p(),h=()=>m(U,"$applications",o),P=()=>m(G,"$predefinedApps",o),M=()=>m(H,"$applicationStore",o),_=g(),q=g(),F=g(),N=g();let O=S(i,"initialApplications",24,()=>[]),Q=S(i,"initialPredefinedApps",24,()=>[]);async function X(){H.update(e=>({...e,loading:!0,autoRefresh:{...e.autoRefresh,isRefreshing:!0}}));try{const e=await J.get("/applications"),a=ae((e.applications||[]).filter(W));H.update(e=>({...e,applications:a,loading:!1,autoRefresh:{...e.autoRefresh,isRefreshing:!1}}))}catch(e){console.error("Error refreshing applications:",e),H.update(e=>({...e,loading:!1,autoRefresh:{...e.autoRefresh,isRefreshing:!1}}))}}function W(e){return e&&e.id&&e.name&&e.status&&e.url&&e.created_at&&""!==e.name.trim()&&""!==e.url}function ae(e){const a=[],s=new Set;for(const t of e)s.has(t.id)||(s.add(t.id),a.push(t));return a}function se(){const e=async()=>{try{const e=await J.get("/applications"),a=ae((e.applications||[]).filter(W));H.update(e=>({...e,applications:a,autoRefresh:{...e.autoRefresh,isRefreshing:!1}}))}catch(e){console.error("Auto-refresh failed:",e),H.update(e=>({...e,autoRefresh:{...e.autoRefresh,isRefreshing:!1}}))}};f(N).enabled&&T.start(e,3e4)}D(()=>{O().length>0&&H.update(e=>({...e,applications:O()})),Q().length>0&&H.update(e=>({...e,predefinedApps:Q()})),0===O().length&&X(),se()}),R(()=>{T.stop()}),s(()=>h(),()=>{u(_,h())}),s(()=>P(),()=>{u(q,P())}),s(()=>(f(F),f(N),M()),()=>{var e;e=M(),u(F,e.loading),u(N,e.autoRefresh)}),t(),r();var te=Pe(),ie=n(te),oe=b(y(ie),2),ne=y(oe),de=y(ne);Z(de,{variant:"outline",get disabled(){return f(F)},class:"inline-flex items-center",$$events:{click:X},children:(e,a)=>{var s=fe(),t=n(s);let r;$(),A(e=>r=V(t,0,"w-4 h-4 mr-2",null,r,e),[()=>({"animate-spin":f(F)})],w),d(e,s)},$$slots:{default:!0}});var ce=b(de,2);const pe=w(()=>(f(N),C(()=>f(N).enabled?"success":"outline")));Z(ce,{get variant(){return f(pe)},get disabled(){return f(F)},class:"inline-flex items-center",$$events:{click:function(){const e=!f(N).enabled;Y(e),e?se():T.stop()}},children:(e,a)=>{var s=he(),t=b(n(s),1,!0);A(()=>j(t,(f(N),C(()=>f(N).enabled?"Auto-refresh ON":"Auto-refresh OFF")))),d(e,s)},$$slots:{default:!0}}),x(ne);var ve=b(ne,2),ue=e=>{var a=xe(),s=b(y(a),4),t=e=>{var a=ye(),s=y(a);x(a),A(()=>j(s,`Next: ${f(N),C(()=>f(N).countdown)??""}s`)),d(e,a)};l(s,e=>{f(N),C(()=>f(N).countdown>0)&&e(t)}),x(a),d(e,a)};l(ve,e=>{f(N),C(()=>f(N).enabled)&&e(ue)}),x(oe);var ge=b(oe,2),Me=b(y(ge),2);z(Me,5,()=>f(q),e=>e.id,(e,a)=>{ee(e,{class:"hover:shadow-lg transition-shadow",children:(e,s)=>{var t=$e(),r=n(t),i=y(r),o=y(i),c=y(o,!0);x(o);var p=b(o,2),v=y(p),u=y(v,!0);x(v);var g=b(v,2),m=y(g,!0);x(g),x(p),x(i);var h=b(i,2),w=y(h,!0);x(h),x(r);var P=b(r,2),M=y(P),_=y(M),S=b(y(_),2),D=y(S,!0);x(S),x(_);var R=b(_,2),V=b(y(R),2),E=y(V);z(E,1,()=>(f(a),C(()=>f(a).features.slice(0,3))),B,(e,a)=>{var s=be(),t=b(y(s),2),r=y(t,!0);x(t),x(s),A(()=>j(r,f(a))),d(e,s)});var L=b(E,2),q=e=>{var s=we(),t=y(s),r=y(t);x(t),x(s),A(()=>j(r,`+${f(a),C(()=>f(a).features.length-3)??""} more features`)),d(e,s)};l(L,e=>{f(a),C(()=>f(a).features.length>3)&&e(q)}),x(V),x(R),x(M),x(P);var F=b(P,2),N=y(F);Z(N,{variant:"primary",size:"sm",class:"w-full",$$events:{click:()=>async function(e){try{H.update(e=>({...e,loading:!0}));const a=await J.get("/applications/prerequisites"),{domains:s,servers:t}=a;if(!s||0===s.length)return void alert("No managed domains found. Please configure SSL for at least one domain first.");if(!t||0===t.length)return void alert("No VPS instances found. Please create at least one VPS with K3s first.");I(e,s,t)}catch(a){console.error("Error checking prerequisites:",a),alert("Failed to load prerequisites. Please check your configuration.")}finally{H.update(e=>({...e,loading:!1}))}}(f(a))},children:(e,a)=>{$();var s=k("Deploy Application");d(e,s)},$$slots:{default:!0}}),x(F),A(()=>{j(c,(f(a),C(()=>f(a).icon))),j(u,(f(a),C(()=>f(a).name))),j(m,(f(a),C(()=>f(a).category))),j(w,(f(a),C(()=>f(a).description))),j(D,(f(a),C(()=>f(a).version)))}),d(e,t)},$$slots:{default:!0}})}),x(Me),x(ge);var _e=b(ge,2),Se=b(y(_e),2),De=e=>{var a=ke();d(e,a)};l(Se,e=>{f(_),f(F),C(()=>0===f(_).length&&!f(F))&&e(De)});var Re=b(Se,2),ze=e=>{var a=je();z(a,5,()=>f(_),e=>e.id,(e,a)=>{ee(e,{class:"hover:shadow-lg transition-shadow",children:(e,s)=>{var t=Ae(),r=n(t),i=y(r),o=y(i),c=y(o),p=y(c,!0);x(c);var v=b(c,2),u=y(v),g=y(u,!0);x(u);var m=b(u,2),h=y(m,!0);x(m),x(v),x(o);var P=b(o,2),M=y(P,!0);x(P),x(i);var _=b(i,2),S=y(_,!0);x(_),x(r);var D=b(r,2),R=y(D),z=y(R),B=b(y(z),2),F=y(B,!0);x(B),x(z);var H=b(z,2),N=b(y(H),2),O=y(N,!0);x(N),x(H);var T=b(H,2),U=b(y(T),2),G=y(U,!0);x(U),x(T);var Y=b(T,2),I=b(y(Y),2),J=y(I,!0);x(I),x(Y),x(R),x(D);var Q=b(D,2),X=y(Q),W=y(X);Z(W,{variant:"primary",size:"xs",class:"flex-1",$$events:{click:()=>function(e){window.open(e.url,"_blank")}(f(a))},children:(e,a)=>{$();var s=k("Visit");d(e,s)},$$slots:{default:!0}});var ee=b(W,2),ae=e=>{var s=Ce(),t=n(s);Z(t,{variant:"secondary",size:"xs",class:"flex-1",$$events:{click:()=>function(e){K(e,"view")}(f(a))},children:(e,a)=>{$();var s=k("👁️ Get Password");d(e,s)},$$slots:{default:!0}});var r=b(t,2);Z(r,{variant:"secondary",size:"xs",class:"flex-1",$$events:{click:()=>function(e){K(e,"change")}(f(a))},children:(e,a)=>{$();var s=k("🔑 Change Password");d(e,s)},$$slots:{default:!0}}),d(e,s)};l(ee,e=>{f(a),C(()=>"code-server"===f(a).app_type||"argocd"===f(a).app_type)&&e(ae)});var se=b(ee,2),te=e=>{Z(e,{variant:"secondary",size:"xs",class:"flex-1",children:(e,a)=>{$();var s=k("🔗 Port Forwarding");d(e,s)},$$slots:{default:!0}})};l(se,e=>{f(a),C(()=>"code-server"===f(a).app_type)&&e(te)});var ie=b(se,2),oe=e=>{Z(e,{variant:"secondary",size:"xs",class:"flex-1",children:(e,a)=>{$();var s=k("🔐 Get Auth Token");d(e,s)},$$slots:{default:!0}})};l(ie,e=>{f(a),C(()=>"headlamp"===f(a).app_type)&&e(oe)});var ne=b(ie,2);Z(ne,{variant:"secondary",size:"xs",class:"flex-1",children:(e,a)=>{$();var s=k("Change Version");d(e,s)},$$slots:{default:!0}});var le=b(ne,2);Z(le,{variant:"danger",size:"xs",class:"flex-1",children:(e,a)=>{$();var s=k("Delete");d(e,s)},$$slots:{default:!0}}),x(X),x(Q),A((e,s,t,r,i)=>{j(p,e),j(g,(f(a),C(()=>f(a).name))),j(h,s),V(P,1,`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t??""}`),j(M,(f(a),C(()=>f(a).status))),j(S,(f(a),C(()=>f(a).description||"No description"))),L(B,"href",(f(a),C(()=>f(a).url))),j(F,r),j(O,(f(a),C(()=>f(a).vps_name))),j(G,(f(a),C(()=>f(a).app_version))),j(J,i)},[()=>(f(a),C(()=>function(e){const a=f(q).find(a=>a.id===e);return a?.icon||"📦"}(f(a).app_type))),()=>(f(a),C(()=>function(e){const a=f(q).find(a=>a.id===e);return a?.name||e}(f(a).app_type))),()=>(f(a),C(()=>function(e){switch(e.toLowerCase()){case"running":case"deployed":return"bg-green-100 text-green-800";case"deploying":case"creating":return"bg-blue-100 text-blue-800";case"pending":return"bg-yellow-100 text-yellow-800";case"failed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}(f(a).status))),()=>(f(a),C(()=>f(a).url.replace("https://",""))),()=>(E(re),f(a),C(()=>re(f(a).created_at)))],w),d(e,t)},$$slots:{default:!0}})}),x(a),d(e,a)};l(Re,e=>{f(_),C(()=>f(_).length>0)&&e(ze)}),x(_e),x(ie);var Ve=b(ie,2);le(Ve,{$$events:{"deployment-success":function(e){X()},"deployment-error":function(e){console.error("Deployment failed:",e.detail),alert("Deployment failed. Please try again.")}}}),me(b(Ve,2),{$$events:{"password-changed":function(e){console.log("Password changed successfully for:",e.detail.app.name)},"password-error":function(e){console.error("Password operation failed:",e.detail),alert("Password operation failed. Please try again.")}}}),d(a,te),c(),v()}var _e=h('<meta name="description" content="Deploy and manage applications on your VPS servers"/>'),Se=h("<!> <!>",1);function De(a,s){e(s,!1);let t=g([]),i=g([]);D(async()=>{try{if("undefined"!=typeof window&&window.initialApplications)u(t,window.initialApplications||[]),u(i,window.initialPredefinedApps||[]);else{const[e,a]=await Promise.all([J.get("/applications/list"),J.get("/applications/predefined")]);u(t,e.applications||[]),u(i,a.predefined_apps||[])}}catch(e){console.error("Error loading initial data:",e)}}),r();var o=Se();q(e=>{var a=_e();F.title="Applications - Xanthus",d(e,a)});var l=n(o);Me(l,{get initialApplications(){return f(t)},get initialPredefinedApps(){return f(i)}});var p=b(l,2);te(p,{}),d(a,o),c()}export{De as component};
