import"../chunks/CWj6FrbW.js";import"../chunks/RaIwcHWQ.js";import{c as kt,o as Pt,a as qt}from"../chunks/ChR5l_r1.js";import{p as tt,l as _,k as lt,aA as At,aB as je,as as re,n as v,o as rt,b0 as Ct,s as n,v as u,g as e,m as k,w as r,x as t,y as s,E as Ve,A as V,B as X,u as d,t as B,z as g,b1 as dt,h as Ft,C as Nt,$ as Ht}from"../chunks/Ce1HVTUQ.js";import{i as at}from"../chunks/BdY6-5Q-.js";import{i as F,s as ct,a as We,p as _t}from"../chunks/C18abfhG.js";import{e as ot,C as yt,i as Ot}from"../chunks/C0w9dAzy.js";import{B as j,b as Mt,r as Tt,a as It,s as Ut}from"../chunks/BZ4NpD64.js";import{s as wt}from"../chunks/bgO99CsW.js";import{a as te,h as Kt,I as Ze,S as it,b as Yt,c as nt,d as Gt,p as Qt,s as Wt,e as Xt,f as bt}from"../chunks/BFgIQtKV.js";import{a as Ae,s as et,b as Dt,d as St}from"../chunks/BJkf_VXN.js";import{L as Jt}from"../chunks/DLRiGjVN.js";function Rt(ae){return function(...N){var U=N[0];return U.stopPropagation(),ae?.apply(this,N)}}const $t=ae=>new Date(ae).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});var Zt=k('<div class="text-2xl mr-3"> </div> <div><h3 class="text-lg font-medium text-gray-900"> </h3> <p class="text-sm text-gray-600"> </p></div>',1),er=k('<div class="bg-gray-50 border border-gray-200 rounded-lg p-4"><div class="flex items-center mb-2"><svg class="w-4 h-4 mr-1 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.102m0 0l4-4a4 4 0 105.656-5.656l-1.102 1.102m-2.828 2.828l4 4"></path></svg> <span class="text-sm font-medium text-gray-700">Application URL</span></div> <p class="text-lg font-mono bg-white px-3 py-2 rounded border"> </p></div>'),tr=k('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"><div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto"><div class="p-6 border-b border-gray-200"><div class="flex items-center justify-between"><div class="flex items-center"><!></div> <button class="text-gray-400 hover:text-gray-600"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div></div> <div class="p-6 space-y-6"><div><!></div> <div class="bg-blue-50 border border-blue-200 rounded-lg p-4"><div class="flex items-center mb-2"><svg class="w-4 h-4 mr-1 text-blue-700" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"></path></svg> <span class="text-sm font-medium text-blue-900">VPS Server *</span></div> <!></div> <div class="bg-green-50 border border-green-200 rounded-lg p-4"><div class="flex items-center mb-2"><svg class="w-4 h-4 mr-1 text-green-700" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9v-9m0-9v9"></path></svg> <span class="text-sm font-medium text-green-900">Domain *</span></div> <!></div> <div><!></div> <div><!></div> <div class="bg-purple-50 border border-purple-200 rounded-lg p-4"><div class="flex items-center mb-2"><svg class="w-4 h-4 mr-1 text-purple-700" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a2 2 0 012-2z"></path></svg> <span class="text-sm font-medium text-purple-900">Version</span></div> <!></div> <!></div> <div class="px-6 py-4 bg-gray-50 border-t border-gray-200 rounded-b-lg"><div class="flex justify-end space-x-3"><!> <!></div></div></div></div>');function rr(ae,N){tt(N,!1);const[U,_e]=ct(),se=()=>We(te,"$applicationStore",U),z=u(),y=u(),w=u(),i=u(),$=u(),b=u(),ve=u(),Ce=u(),ye=u(),we=u(),oe=kt();let C=u(""),K=u(""),L=u(""),Y=u(""),Me=u(""),J=u(""),Z=u([]),ie=u(!1);function Te(){e(i)&&(n(C,`my-${e(i).id}`),n(K,""),n(L,""),n(Y,e(i).id),n(Me,`My ${e(i).name} instance`),n(J,e(i).version),n(Z,[]))}async function Ie(){if(e(i)){n(ie,!0);try{const c=await Ae.get(`/applications/versions/${e(i).id}`);if(c.success&&c.versions&&(n(Z,c.versions),!e(J)&&e(Z).length>0)){const D=e(Z).find(ne=>ne.version===e(i).version)||e(Z)[0];n(J,D.version)}}catch(c){console.warn("Failed to fetch versions:",c),n(Z,[{version:e(i).version,is_latest:!1,is_stable:!0}]),n(J,e(i).version)}finally{n(ie,!1)}}}function pe(){Kt()}async function Ue(){if(!(!e(ve)||!e(i))){et(!0),Dt("Deploying Application"),St(`Deploying ${e(i).name} to your VPS...`);try{const c={app_type:e(i).id,name:e(C).trim(),vps_id:e(K),domain:e(L),subdomain:e(Y).trim(),description:e(Me).trim(),version:e(J)},D=await Ae.post("/applications/deploy",c);if(D.success)oe("deployment-success",D),pe(),console.log("Application deployed successfully");else throw new Error(D.error||"Deployment failed")}catch(c){console.error("Deployment error:",c),oe("deployment-error",c)}finally{et(!1)}}}function Ke(c){c.key==="Escape"&&pe()}_(()=>(e(z),se()),()=>{(c=>{n(z,c.modals)})(se())}),_(()=>e(z),()=>{n(y,e(z).deployment)}),_(()=>e(y),()=>{n(w,e(y).show)}),_(()=>e(y),()=>{n(i,e(y).predefinedApp)}),_(()=>e(y),()=>{n($,e(y).domains)}),_(()=>e(y),()=>{n(b,e(y).servers)}),_(()=>(e(C),e(K),e(L),e(Y)),()=>{n(ve,e(C).trim()!==""&&e(K)!==""&&e(L)!==""&&e(Y).trim()!=="")}),_(()=>(e(w),e(i)),()=>{e(w)&&e(i)&&(Te(),Ie())}),_(()=>e($),()=>{n(Ce,e($).map(c=>({value:c.name,label:c.name})))}),_(()=>e(b),()=>{n(ye,e(b).map(c=>({value:c.id,label:`${c.name} (${c.public_net.ipv4.ip})`})))}),_(()=>e(Z),()=>{n(we,e(Z).map(c=>({value:c.version,label:`${c.version}${c.is_latest?" (Latest)":""}${c.is_stable?"":" (Pre-release)"}`})))}),lt(),at();var m=At();je("keydown",Ct,Ke);var ue=re(m);{var be=c=>{var D=tr(),ne=r(D),De=r(ne),Se=r(De),Be=r(Se),Re=r(Be);{var qe=f=>{var R=Zt(),P=re(R),me=r(P,!0);t(P);var le=s(P,2),W=r(le),xe=r(W);t(W);var I=s(W,2),Le=r(I,!0);t(I),t(le),B(()=>{g(me,(e(i),d(()=>e(i).icon))),g(xe,`Deploy ${e(i),d(()=>e(i).name)??""}`),g(Le,(e(i),d(()=>e(i).description)))}),v(f,R)};F(Re,f=>{e(i)&&f(qe)})}t(Be);var Fe=s(Be,2);t(Se),t(De);var fe=s(De,2),ze=r(fe),Ye=r(ze);const Ge=Ve(()=>(e(i),d(()=>e(i)?.id||"app")));Ze(Ye,{label:"Application Name",get placeholder(){return`my-${e(Ge)??""}`},help:"A friendly name for your application instance",required:!0,get value(){return e(C)},set value(f){n(C,f)},$$legacy:!0}),t(ze);var $e=s(ze,2),Ne=s(r($e),2);it(Ne,{get options(){return e(ye)},placeholder:"👆 Click to choose a VPS server",help:"Select the server where your application will be deployed",class:"border-blue-300 focus:border-blue-500 focus:ring-blue-500",required:!0,get value(){return e(K)},set value(f){n(K,f)},$$legacy:!0}),t($e);var a=s($e,2),l=s(r(a),2);it(l,{get options(){return e(Ce)},placeholder:"👆 Click to select a domain",help:"Choose the domain for your application",class:"border-green-300 focus:border-green-500 focus:ring-green-500",required:!0,get value(){return e(L)},set value(f){n(L,f)},$$legacy:!0}),t(a);var p=s(a,2),o=r(p);const x=Ve(()=>(e(i),d(()=>e(i)?.id||"app")));Ze(o,{label:"Subdomain",get placeholder(){return e(x)},help:"Your app will be available at subdomain.domain.com",required:!0,get value(){return e(Y)},set value(f){n(Y,f)},$$legacy:!0}),t(p);var h=s(p,2),M=r(h);const E=Ve(()=>(e(i),d(()=>e(i)?.name||"application")));Ze(M,{label:"Description (optional)",get placeholder(){return`My ${e(E)??""} instance`},help:"Optional description for this application instance",get value(){return e(Me)},set value(f){n(Me,f)},$$legacy:!0}),t(h);var q=s(h,2),G=s(r(q),2);it(G,{get options(){return e(we)},placeholder:"Select version...",help:"Choose the application version to deploy",get loading(){return e(ie)},class:"border-purple-300 focus:border-purple-500 focus:ring-purple-500",get value(){return e(J)},set value(f){n(J,f)},$$legacy:!0}),t(q);var H=s(q,2);{var O=f=>{var R=er(),P=s(r(R),2),me=r(P);t(P),t(R),B(()=>g(me,`https://${e(Y)??""}.${e(L)??""}`)),v(f,R)};F(H,f=>{e(L)&&e(Y)&&f(O)})}t(fe);var S=s(fe,2),T=r(S),Q=r(T);j(Q,{variant:"outline",$$events:{click:pe},children:(f,R)=>{V();var P=X("Cancel");v(f,P)},$$slots:{default:!0}});var ge=s(Q,2);const ke=Ve(()=>!e(ve));j(ge,{variant:"primary",get disabled(){return e(ke)},class:"bg-purple-600 hover:bg-purple-700",$$events:{click:Ue},children:(f,R)=>{V();var P=X("Deploy Application");v(f,P)},$$slots:{default:!0}}),t(T),t(S),t(ne),t(D),je("click",Fe,pe),je("click",ne,Rt(function(f){Mt.call(this,N,f)})),je("click",D,pe),v(c,D)};F(ue,c=>{e(w)&&c(be)})}v(ae,m),rt(),_e()}var ar=k('<div class="flex items-center justify-center py-8"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div> <span class="ml-2 text-gray-600">Loading password...</span></div>'),sr=dt('<svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg> ',1),or=k('<div class="p-4 bg-blue-50 border border-blue-200 rounded-lg"><h4 class="font-medium text-blue-900 mb-2">🔐 Password</h4> <div class="flex items-center space-x-2"><input type="text" class="flex-1 px-3 py-2 border border-blue-300 rounded font-mono text-sm bg-white" readonly=""/> <!></div> <p class="text-sm text-blue-700 mt-2"> </p></div> <div class="p-4 bg-green-50 border border-green-200 rounded-lg"><h4 class="font-medium text-green-900 mb-2">🔗 Quick Access</h4> <div class="text-center"><!></div></div>',1),ir=k('<div class="space-y-6"><p class="text-gray-700">Current password for <strong> </strong>:</p> <!></div>'),nr=k('<div class="space-y-6"><p class="text-gray-700">Change the password for <strong> </strong>:</p> <div class="p-3 bg-yellow-50 border border-yellow-200 rounded-md"><div class="flex items-center"><svg class="w-5 h-5 text-yellow-600 mr-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg> <span class="text-sm text-yellow-800"> </span></div></div> <div><!></div></div>'),lr=k('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"><div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto"><div class="p-6 border-b border-gray-200"><div class="flex items-center justify-between"><div class="flex items-center"><div class="text-2xl mr-3">🔐</div> <div><h3 class="text-lg font-medium text-gray-900"> </h3> <p class="text-sm text-gray-600"> </p></div></div> <button class="text-gray-400 hover:text-gray-600"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div></div> <div class="p-6"><!></div> <div class="px-6 py-4 bg-gray-50 border-t border-gray-200 rounded-b-lg"><div class="flex justify-end space-x-3"><!> <!></div></div></div></div>');function dr(ae,N){tt(N,!1);const[U,_e]=ct(),se=()=>We(te,"$applicationStore",U),z=u(),y=u(),w=u(),i=u(),$=u(),b=u(),ve=u(),Ce=u(),ye=u(),we=kt();let oe=u(""),C=u(""),K=u(!1),L=u("Copy");function Y(){n(oe,""),n(C,""),n(K,!1),n(L,"Copy")}async function Me(){if(e(i)){n(K,!0);try{const m=await Ae.get(`/applications/${e(i).id}/password`);if(m.password)n(oe,m.password);else throw new Error(m.error||"Failed to retrieve password")}catch(m){console.error("Error retrieving password:",m),we("password-error",m)}finally{n(K,!1)}}}async function J(){if(!(!e(i)||!e(C).trim())){et(!0),Dt("Changing Password"),St(`Updating password for "${e(i).name}"...`);try{const m=await Ae.post(`/applications/${e(i).id}/password`,{password:e(C).trim()});if(m.success)we("password-changed",{app:e(i),newPassword:e(C).trim()}),ie();else throw new Error(m.error||"Failed to change password")}catch(m){console.error("Password change error:",m),we("password-error",m)}finally{et(!1)}}}async function Z(){if(e(oe))try{await navigator.clipboard.writeText(e(oe)),n(L,"Copied!"),setTimeout(()=>{n(L,"Copy")},2e3)}catch(m){console.error("Failed to copy password:",m)}}function ie(){Yt()}function Te(){e(i)?.url&&window.open(e(i).url,"_blank")}function Ie(m){m.key==="Escape"?ie():m.key==="Enter"&&e($)==="change"&&e(C).trim()&&J()}_(()=>(e(z),se()),()=>{(m=>{n(z,m.modals)})(se())}),_(()=>e(z),()=>{n(y,e(z).password)}),_(()=>e(y),()=>{n(w,e(y).show)}),_(()=>e(y),()=>{n(i,e(y).app)}),_(()=>e(y),()=>{n($,e(y).mode)}),_(()=>e(i),()=>{n(b,e(i)?.app_type==="argocd"?"ArgoCD":"Code-Server")}),_(()=>e(i),()=>{n(ve,e(i)?.app_type==="argocd"?"You can use this password to access your ArgoCD admin interface":"You can use this password to access your code-server instance")}),_(()=>e(i),()=>{n(Ce,e(i)?.app_type==="argocd"?"Open ArgoCD":"Open Code-Server")}),_(()=>e(i),()=>{n(ye,e(i)?.app_type==="argocd"?"This will restart your ArgoCD instance":"This will restart your code-server instance")}),_(()=>(e(w),e(i),e($)),()=>{e(w)&&e(i)&&(Y(),e($)==="view"&&Me())}),lt(),at();var pe=At();je("keydown",Ct,Ie);var Ue=re(pe);{var Ke=m=>{var ue=lr(),be=r(ue),c=r(be),D=r(c),ne=r(D),De=s(r(ne),2),Se=r(De),Be=r(Se,!0);t(Se);var Re=s(Se,2),qe=r(Re,!0);t(Re),t(De),t(ne);var Fe=s(ne,2);t(D),t(c);var fe=s(c,2),ze=r(fe);{var Ye=o=>{var x=ir(),h=r(x),M=s(r(h)),E=r(M,!0);t(M),V(),t(h);var q=s(h,2);{var G=O=>{var S=ar();v(O,S)},H=O=>{var S=or(),T=re(S),Q=s(r(T),2),ge=r(Q);Tt(ge);var ke=s(ge,2);j(ke,{variant:"primary",size:"sm",class:"bg-blue-600 hover:bg-blue-700",$$events:{click:Z},children:(W,xe)=>{V();var I=X();B(()=>g(I,e(L))),v(W,I)},$$slots:{default:!0}}),t(Q);var f=s(Q,2),R=r(f);t(f),t(T);var P=s(T,2),me=s(r(P),2),le=r(me);j(le,{variant:"primary",class:"bg-purple-600 hover:bg-purple-700 inline-flex items-center",$$events:{click:Te},children:(W,xe)=>{var I=sr(),Le=s(re(I),1,!0);B(()=>g(Le,e(Ce))),v(W,I)},$$slots:{default:!0}}),t(me),t(P),B(()=>{It(ge,e(oe)),g(R,`💡 ${e(ve)??""}`)}),v(O,S)};F(q,O=>{e(K)?O(G):O(H,!1)})}t(x),B(()=>g(E,(e(i),d(()=>e(i).name)))),v(o,x)},Ge=o=>{var x=nr(),h=r(x),M=s(r(h)),E=r(M,!0);t(M),V(),t(h);var q=s(h,2),G=r(q),H=s(r(G),2),O=r(H,!0);t(H),t(G),t(q);var S=s(q,2),T=r(S);Ze(T,{label:"New Password",type:"password",placeholder:"Enter new password...",help:"Choose a secure password for your application",required:!0,class:"font-mono",get value(){return e(C)},set value(Q){n(C,Q)},$$legacy:!0}),t(S),t(x),B(()=>{g(E,(e(i),d(()=>e(i).name))),g(O,e(ye))}),v(o,x)};F(ze,o=>{e($)==="view"?o(Ye):o(Ge,!1)})}t(fe);var $e=s(fe,2),Ne=r($e),a=r(Ne);j(a,{variant:"outline",$$events:{click:ie},children:(o,x)=>{V();var h=X();B(()=>g(h,e($)==="view"?"Close":"Cancel")),v(o,h)},$$slots:{default:!0}});var l=s(a,2);{var p=o=>{const x=Ve(()=>(e(C),d(()=>!e(C).trim())));j(o,{variant:"primary",get disabled(){return e(x)},class:"bg-green-600 hover:bg-green-700",$$events:{click:J},children:(h,M)=>{V();var E=X("Change Password");v(h,E)},$$slots:{default:!0}})};F(l,o=>{e($)==="change"&&o(p)})}t(Ne),t($e),t(be),t(ue),B(()=>{g(Be,e($)==="view"?"Current Password":`Change ${e(b)} Password`),g(qe,(e(i),d(()=>e(i).name)))}),je("click",Fe,ie),je("click",be,Rt(function(o){Mt.call(this,N,o)})),je("click",ue,ie),v(m,ue)};F(Ue,m=>{e(w)&&e(i)&&m(Ke)})}v(ae,pe),rt(),_e()}var cr=dt('<svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg> Refresh',1),vr=dt('<svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg> ',1),pr=k('<span class="text-xs bg-gray-200 px-2 py-1 rounded"> </span>'),ur=k('<div class="text-sm text-gray-500 flex items-center space-x-2"><svg class="w-4 h-4 text-green-500 animate-pulse" fill="currentColor" viewBox="0 0 20 20"><circle cx="10" cy="10" r="3"></circle></svg> <span>Auto-refresh: every 30 seconds</span> <!></div>'),fr=k('<div class="text-xs text-gray-600 flex items-center"><svg class="w-3 h-3 text-green-500 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> <span> </span></div>'),gr=k('<div class="text-xs text-gray-400"><span> </span></div>'),mr=k('<div class="p-6 border-b border-gray-200"><div class="flex items-center"><div class="text-3xl mr-4"> </div> <div class="flex-1"><h4 class="text-lg font-medium text-gray-900"> </h4> <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800"> </span></div></div> <p class="text-sm text-gray-500 mt-3"> </p></div> <div class="p-6"><div class="space-y-3"><div class="flex items-center justify-between"><span class="text-sm text-gray-500">Version:</span> <span class="text-sm font-medium text-gray-900"> </span></div> <div><span class="text-sm text-gray-500 block mb-2">Features:</span> <div class="space-y-1"><!> <!></div></div></div></div> <div class="px-6 py-4 bg-gray-50 border-t border-gray-200 rounded-b-lg"><!></div>',1),xr=k('<div class="text-center py-12 bg-white rounded-lg shadow-md"><svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg> <h4 class="mt-2 text-lg font-medium text-gray-900">No applications deployed</h4> <p class="mt-1 text-gray-500">Deploy your first application from the catalog above.</p></div>'),hr=k("<!> <!>",1),_r=k('<div class="p-6 border-b border-gray-200"><div class="flex items-center justify-between"><div class="flex items-center"><div class="text-2xl mr-3"> </div> <div><h4 class="text-lg font-medium text-gray-900"> </h4> <span class="text-sm text-gray-500"> </span></div></div> <span> </span></div> <p class="text-sm text-gray-500 mt-2"> </p></div> <div class="p-6"><div class="space-y-3"><div class="flex items-center justify-between"><span class="text-sm text-gray-500">URL:</span> <a target="_blank" class="text-sm font-medium text-purple-600 hover:text-purple-800 truncate max-w-48"> </a></div> <div class="flex items-center justify-between"><span class="text-sm text-gray-500">VPS:</span> <span class="text-sm font-medium text-gray-900"> </span></div> <div class="flex items-center justify-between"><span class="text-sm text-gray-500">Version:</span> <span class="text-sm font-medium text-gray-900"> </span></div> <div class="flex items-center justify-between"><span class="text-sm text-gray-500">Created:</span> <span class="text-sm font-medium text-gray-900"> </span></div></div></div> <div class="px-6 py-4 bg-gray-50 border-t border-gray-200 rounded-b-lg"><div class="flex flex-wrap gap-2"><!> <!> <!> <!> <!> <!></div></div>',1),yr=k('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>'),wr=k('<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><div class="mb-8"><h2 class="text-3xl font-bold text-gray-900 mb-2">Applications</h2> <p class="text-gray-600">Deploy and manage curated applications on your VPS servers</p></div> <div class="flex justify-between items-center mb-6"><div class="flex space-x-3"><!> <!></div> <!></div> <div class="mb-12"><h3 class="text-xl font-semibold text-gray-900 mb-4">Available Applications</h3> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div></div> <div><h3 class="text-xl font-semibold text-gray-900 mb-4">Deployed Applications</h3> <!> <!></div></div> <!> <!>',1);function br(ae,N){tt(N,!1);const[U,_e]=ct(),se=()=>We(Gt,"$applications",U),z=()=>We(Qt,"$predefinedApps",U),y=()=>We(te,"$applicationStore",U),w=u(),i=u(),$=u(),b=u();let ve=_t(N,"initialApplications",24,()=>[]),Ce=_t(N,"initialPredefinedApps",24,()=>[]);Pt(()=>{ve().length>0&&te.update(a=>({...a,applications:ve()})),Ce().length>0&&te.update(a=>({...a,predefinedApps:Ce()})),ve().length===0&&ye(),Y()}),qt(()=>{nt.stop()});async function ye(){te.update(a=>({...a,loading:!0,autoRefresh:{...a.autoRefresh,isRefreshing:!0}}));try{const l=((await Ae.get("/applications/list")).applications||[]).filter(we),p=oe(l);te.update(o=>({...o,applications:p,loading:!1,autoRefresh:{...o.autoRefresh,isRefreshing:!1}}))}catch(a){console.error("Error refreshing applications:",a),te.update(l=>({...l,loading:!1,autoRefresh:{...l.autoRefresh,isRefreshing:!1}}))}}function we(a){return a&&a.id&&a.name&&a.status&&a.url&&a.created_at&&a.name.trim()!==""&&a.url!==""}function oe(a){const l=[],p=new Set;for(const o of a)p.has(o.id)||(p.add(o.id),l.push(o));return l}function C(a){return e(i).find(p=>p.id===a)?.icon||"📦"}function K(a){return e(i).find(p=>p.id===a)?.name||a}function L(a){switch(a.toLowerCase()){case"running":case"deployed":return"bg-green-100 text-green-800";case"deploying":case"creating":return"bg-blue-100 text-blue-800";case"pending":return"bg-yellow-100 text-yellow-800";case"failed":return"bg-red-100 text-red-800";case"not deployed":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}}function Y(){const a=async()=>{try{const p=((await Ae.get("/applications/list")).applications||[]).filter(we),o=oe(p);te.update(x=>({...x,applications:o,autoRefresh:{...x.autoRefresh,isRefreshing:!1}}))}catch(l){console.error("Auto-refresh failed:",l),te.update(p=>({...p,autoRefresh:{...p.autoRefresh,isRefreshing:!1}}))}};e(b).enabled&&nt.start(a,3e4)}function Me(){const a=!e(b).enabled;Wt(a),a?Y():nt.stop()}function J(a){window.open(a.url,"_blank")}async function Z(a){try{te.update(x=>({...x,loading:!0}));const l=await Ae.get("/applications/prerequisites"),{domains:p,servers:o}=l;if(!p||p.length===0){alert("No managed domains found. Please configure SSL for at least one domain first.");return}if(!o||o.length===0){alert("No VPS instances found. Please create at least one VPS with K3s first.");return}Xt(a,p,o)}catch(l){console.error("Error checking prerequisites:",l),alert("Failed to load prerequisites. Please check your configuration.")}finally{te.update(l=>({...l,loading:!1}))}}function ie(a){ye()}function Te(a){console.error("Deployment failed:",a.detail),alert("Deployment failed. Please try again.")}function Ie(a){bt(a,"view")}function pe(a){bt(a,"change")}function Ue(a){console.log("Password changed successfully for:",a.detail.app.name)}function Ke(a){console.error("Password operation failed:",a.detail),alert("Password operation failed. Please try again.")}_(()=>se(),()=>{n(w,se())}),_(()=>z(),()=>{n(i,z())}),_(()=>(e($),e(b),y()),()=>{(a=>{n($,a.loading),n(b,a.autoRefresh)})(y())}),lt(),at();var m=wr(),ue=re(m),be=s(r(ue),2),c=r(be),D=r(c);j(D,{variant:"outline",get disabled(){return e($)},class:"inline-flex items-center",$$events:{click:ye},children:(a,l)=>{var p=cr(),o=re(p);let x;V(),B(h=>x=wt(o,0,"w-4 h-4 mr-2",null,x,h),[()=>({"animate-spin":e($)})],Ve),v(a,p)},$$slots:{default:!0}});var ne=s(D,2);const De=Ve(()=>(e(b),d(()=>e(b).enabled?"success":"outline")));j(ne,{get variant(){return e(De)},get disabled(){return e($)},class:"inline-flex items-center",$$events:{click:Me},children:(a,l)=>{var p=vr(),o=s(re(p),1,!0);B(()=>g(o,(e(b),d(()=>e(b).enabled?"Auto-refresh ON":"Auto-refresh OFF")))),v(a,p)},$$slots:{default:!0}}),t(c);var Se=s(c,2);{var Be=a=>{var l=ur(),p=s(r(l),4);{var o=x=>{var h=pr(),M=r(h);t(h),B(()=>g(M,`Next: ${e(b),d(()=>e(b).countdown)??""}s`)),v(x,h)};F(p,x=>{e(b),d(()=>e(b).countdown>0)&&x(o)})}t(l),v(a,l)};F(Se,a=>{e(b),d(()=>e(b).enabled)&&a(Be)})}t(be);var Re=s(be,2),qe=s(r(Re),2);ot(qe,5,()=>e(i),a=>a.id,(a,l)=>{yt(a,{class:"hover:shadow-lg transition-shadow",children:(p,o)=>{var x=mr(),h=re(x),M=r(h),E=r(M),q=r(E,!0);t(E);var G=s(E,2),H=r(G),O=r(H,!0);t(H);var S=s(H,2),T=r(S,!0);t(S),t(G),t(M);var Q=s(M,2),ge=r(Q,!0);t(Q),t(h);var ke=s(h,2),f=r(ke),R=r(f),P=s(r(R),2),me=r(P,!0);t(P),t(R);var le=s(R,2),W=s(r(le),2),xe=r(W);ot(xe,1,()=>(e(l),d(()=>e(l).features.slice(0,3))),Ot,(Pe,he)=>{var de=fr(),Oe=s(r(de),2),Je=r(Oe,!0);t(Oe),t(de),B(()=>g(Je,e(he))),v(Pe,de)});var I=s(xe,2);{var Le=Pe=>{var he=gr(),de=r(he),Oe=r(de);t(de),t(he),B(()=>g(Oe,`+${e(l),d(()=>e(l).features.length-3)??""} more features`)),v(Pe,he)};F(I,Pe=>{e(l),d(()=>e(l).features.length>3)&&Pe(Le)})}t(W),t(le),t(f),t(ke);var He=s(ke,2),Xe=r(He);j(Xe,{variant:"primary",size:"sm",class:"w-full",$$events:{click:()=>Z(e(l))},children:(Pe,he)=>{V();var de=X("Deploy Application");v(Pe,de)},$$slots:{default:!0}}),t(He),B(()=>{g(q,(e(l),d(()=>e(l).icon))),g(O,(e(l),d(()=>e(l).name))),g(T,(e(l),d(()=>e(l).category))),g(ge,(e(l),d(()=>e(l).description))),g(me,(e(l),d(()=>e(l).version)))}),v(p,x)},$$slots:{default:!0}})}),t(qe),t(Re);var Fe=s(Re,2),fe=s(r(Fe),2);{var ze=a=>{var l=xr();v(a,l)};F(fe,a=>{e(w),e($),d(()=>e(w).length===0&&!e($))&&a(ze)})}var Ye=s(fe,2);{var Ge=a=>{var l=yr();ot(l,5,()=>e(w),p=>p.id,(p,o)=>{yt(p,{class:"hover:shadow-lg transition-shadow",children:(x,h)=>{var M=_r(),E=re(M),q=r(E),G=r(q),H=r(G),O=r(H,!0);t(H);var S=s(H,2),T=r(S),Q=r(T,!0);t(T);var ge=s(T,2),ke=r(ge,!0);t(ge),t(S),t(G);var f=s(G,2),R=r(f,!0);t(f),t(q);var P=s(q,2),me=r(P,!0);t(P),t(E);var le=s(E,2),W=r(le),xe=r(W),I=s(r(xe),2),Le=r(I,!0);t(I),t(xe);var He=s(xe,2),Xe=s(r(He),2),Pe=r(Xe,!0);t(Xe),t(He);var he=s(He,2),de=s(r(he),2),Oe=r(de,!0);t(de),t(he);var Je=s(he,2),vt=s(r(Je),2),jt=r(vt,!0);t(vt),t(Je),t(W),t(le);var pt=s(le,2),ut=r(pt),ft=r(ut);j(ft,{variant:"primary",size:"xs",class:"flex-1",$$events:{click:()=>J(e(o))},children:(A,ce)=>{V();var ee=X("Visit");v(A,ee)},$$slots:{default:!0}});var gt=s(ft,2);{var Vt=A=>{var ce=hr(),ee=re(ce);j(ee,{variant:"secondary",size:"xs",class:"flex-1",$$events:{click:()=>Ie(e(o))},children:(Qe,Et)=>{V();var st=X("👁️ Get Password");v(Qe,st)},$$slots:{default:!0}});var Ee=s(ee,2);j(Ee,{variant:"secondary",size:"xs",class:"flex-1",$$events:{click:()=>pe(e(o))},children:(Qe,Et)=>{V();var st=X("🔑 Change Password");v(Qe,st)},$$slots:{default:!0}}),v(A,ce)};F(gt,A=>{e(o),d(()=>e(o).app_type==="code-server"||e(o).app_type==="argocd")&&A(Vt)})}var mt=s(gt,2);{var Bt=A=>{j(A,{variant:"secondary",size:"xs",class:"flex-1",children:(ce,ee)=>{V();var Ee=X("🔗 Port Forwarding");v(ce,Ee)},$$slots:{default:!0}})};F(mt,A=>{e(o),d(()=>e(o).app_type==="code-server")&&A(Bt)})}var xt=s(mt,2);{var zt=A=>{j(A,{variant:"secondary",size:"xs",class:"flex-1",children:(ce,ee)=>{V();var Ee=X("🔐 Get Auth Token");v(ce,Ee)},$$slots:{default:!0}})};F(xt,A=>{e(o),d(()=>e(o).app_type==="headlamp")&&A(zt)})}var ht=s(xt,2);j(ht,{variant:"secondary",size:"xs",class:"flex-1",children:(A,ce)=>{V();var ee=X("Change Version");v(A,ee)},$$slots:{default:!0}});var Lt=s(ht,2);j(Lt,{variant:"danger",size:"xs",class:"flex-1",children:(A,ce)=>{V();var ee=X("Delete");v(A,ee)},$$slots:{default:!0}}),t(ut),t(pt),B((A,ce,ee,Ee,Qe)=>{g(O,A),g(Q,(e(o),d(()=>e(o).name))),g(ke,ce),wt(f,1,`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${ee??""}`),g(R,(e(o),d(()=>e(o).status))),g(me,(e(o),d(()=>e(o).description||"No description"))),Ut(I,"href",(e(o),d(()=>e(o).url))),g(Le,Ee),g(Pe,(e(o),d(()=>e(o).vps_name))),g(Oe,(e(o),d(()=>e(o).app_version))),g(jt,Qe)},[()=>(e(o),d(()=>C(e(o).app_type))),()=>(e(o),d(()=>K(e(o).app_type))),()=>(e(o),d(()=>L(e(o).status))),()=>(e(o),d(()=>e(o).url.replace("https://",""))),()=>(Ft($t),e(o),d(()=>$t(e(o).created_at)))],Ve),v(x,M)},$$slots:{default:!0}})}),t(l),v(a,l)};F(Ye,a=>{e(w),d(()=>e(w).length>0)&&a(Ge)})}t(Fe),t(ue);var $e=s(ue,2);rr($e,{$$events:{"deployment-success":ie,"deployment-error":Te}});var Ne=s($e,2);dr(Ne,{$$events:{"password-changed":Ue,"password-error":Ke}}),v(ae,m),rt(),_e()}var $r=k('<meta name="description" content="Deploy and manage applications on your VPS servers"/>'),kr=k("<!> <!>",1);function Er(ae,N){tt(N,!1);let U=u([]),_e=u([]);Pt(async()=>{try{if(typeof window<"u"&&window.initialApplications)n(U,window.initialApplications||[]),n(_e,window.initialPredefinedApps||[]);else{const[w,i]=await Promise.all([Ae.get("/applications/list"),Ae.get("/applications/predefined")]);n(U,w.applications||[]),n(_e,i.predefined_apps||[])}}catch(w){console.error("Error loading initial data:",w)}}),at();var se=kr();Nt(w=>{var i=$r();Ht.title="Applications - Xanthus",v(w,i)});var z=re(se);br(z,{get initialApplications(){return e(U)},get initialPredefinedApps(){return e(_e)}});var y=s(z,2);Jt(y,{}),v(ae,se),rt()}export{Er as component};
