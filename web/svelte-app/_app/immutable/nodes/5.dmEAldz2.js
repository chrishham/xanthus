import{_ as ct}from"../chunks/CmsKOCeN.js";import"../chunks/CWj6FrbW.js";import"../chunks/RaIwcHWQ.js";import{o as St}from"../chunks/ChR5l_r1.js";import{D as ut,p as It,m as x,C as Mt,n as c,o as Rt,$ as Ut,B as at,t as V,g as e,w as a,s as R,v as q,y as i,A as W,z as m,x as r,E as U}from"../chunks/Ce1HVTUQ.js";import{i as k}from"../chunks/C18abfhG.js";import{C as F,e as zt,i as At}from"../chunks/C0w9dAzy.js";import{B as st,s as jt}from"../chunks/BZ4NpD64.js";import{t as Dt,s as pt}from"../chunks/bgO99CsW.js";import{i as Xt}from"../chunks/BdY6-5Q-.js";import{a as G,s as mt,c as ft}from"../chunks/BJkf_VXN.js";function Ot(P,z,l,d){var b=P.__style;if(ut||b!==z){var y=Dt(z);(!ut||y!==P.getAttribute("style"))&&(y==null?P.removeAttribute("style"):P.style.cssText=y),P.__style=z}return d}var Nt=x('<div class="mt-3 p-3 bg-red-50 border border-red-200 rounded-md"><p class="text-sm text-red-800"> </p></div>'),Ht=x('<div class="p-6"><div class="flex items-center justify-between mb-4"><h3 class="text-lg font-medium text-gray-900">Update in Progress</h3> <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"> </span></div> <div class="mb-4"><div class="flex justify-between text-sm text-gray-600 mb-1"><span> </span> <span> </span></div> <div class="w-full bg-gray-200 rounded-full h-2"><div></div></div></div> <p class="text-sm text-gray-600"> </p> <!></div>'),qt=x('<div class="mb-6"><!></div>'),Wt=x('<div class="p-6"><h3 class="text-lg font-medium text-gray-900 mb-4">Current Version</h3> <div class="flex items-center justify-between"><div><p class="text-2xl font-bold text-blue-600"> </p> <p class="text-sm text-gray-600">Currently running</p></div> <div class="flex space-x-2"><!></div></div></div>'),Ft=x('<div class="mb-6"><!></div>'),Gt=x('<div class="bg-red-50 border border-red-200 rounded-md p-4"><div class="flex"><div class="flex-shrink-0"><svg class="h-5 w-5 text-red-400" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg></div> <div class="ml-3"><h3 class="text-sm font-medium text-red-800">Error</h3> <p class="mt-1 text-sm text-red-700"> </p></div></div></div>'),Yt=x('<div class="mb-6"><!></div>'),Jt=x('<div class="text-center py-12"><div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div> <p class="mt-2 text-sm text-gray-600">Loading version information...</p></div>'),Kt=x('<div class="text-sm text-gray-700 bg-gray-50 rounded-md p-3 mb-3"><pre class="whitespace-pre-wrap font-mono text-xs"> </pre></div>'),Qt=x('<div class="p-6"><div class="flex items-start justify-between"><div class="flex-1"><div class="flex items-center space-x-3 mb-2"><h4 class="text-lg font-semibold text-gray-900"> </h4> <span> </span></div> <h5 class="text-md font-medium text-gray-700 mb-2"> </h5> <div class="text-sm text-gray-600 mb-3"><p> </p></div> <!></div> <div class="flex items-center space-x-2 ml-4"><!> <a target="_blank" class="inline-flex items-center px-3 py-1.5 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">View on GitHub <svg class="ml-1 w-3 h-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></a></div></div></div>'),Zt=x('<div><h3 class="text-lg font-medium text-gray-900 mb-4">Available Versions</h3> <div class="grid grid-cols-1 gap-4"></div></div>'),te=x(`<div class="text-center py-12"><svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <h3 class="mt-2 text-sm font-medium text-gray-900">No updates available</h3> <p class="mt-1 text-sm text-gray-500">You're running the latest version of Xanthus.</p></div>`),ee=x('<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><div class="mb-8"><h2 class="text-3xl font-bold text-gray-900 mb-2">Version Management</h2> <p class="text-gray-600">Manage platform updates and monitor version status</p></div> <div class="mb-6"><!></div> <!> <!> <!> <!> <!> <!></div>');function me(P,z){It(z,!1);let l=q(null),d=q(null),b=q(!1),y=q(""),T=null;St(async()=>(await Y(),await D(),e(d)?.in_progress&&J(),()=>{T&&clearInterval(T)}));async function Y(){R(b,!0),R(y,"");try{R(l,await G.get("/version/available"))}catch(t){R(y,t instanceof Error?t.message:"Failed to load version information"),console.error("Error loading version info:",t)}finally{R(b,!1)}}async function D(){try{R(d,await G.get("/version/status"))}catch(t){console.error("Error loading update status:",t)}}function J(){T&&clearInterval(T),T=setInterval(async()=>{await D(),e(d)?.in_progress||(clearInterval(T),T=null,await Y())},2e3)}async function gt(t){try{const{default:s}=await ct(async()=>{const{default:u}=await import("../chunks/0MHz4Was.js");return{default:u}},[],import.meta.url);(await s.fire({title:`Update to ${t}?`,html:`
					<div class="text-left">
						<p class="mb-4">This will update Xanthus to version <strong>${t}</strong>.</p>
						<div class="bg-yellow-50 border border-yellow-200 rounded-md p-3">
							<p class="text-sm text-yellow-800">
								<strong>Warning:</strong> The platform will restart during the update process. This may take a few minutes.
							</p>
						</div>
						<p class="mt-3 text-sm text-gray-600">
							The previous version will be available for rollback if needed.
						</p>
					</div>
				`,icon:"question",showCancelButton:!0,confirmButtonText:"Start Update",cancelButtonText:"Cancel",confirmButtonColor:"#3b82f6",showLoaderOnConfirm:!0,preConfirm:async()=>{try{return mt("Starting update...","Please wait while we prepare the update"),await G.post("/version/update",{version:t})}catch(u){s.showValidationMessage("Error: "+u.message)}finally{ft()}}})).isConfirmed&&(await s.fire({title:"Update Started!",text:`Xanthus is updating to ${t}. The platform will restart when complete.`,icon:"success",confirmButtonColor:"#10b981"}),await D(),e(d)?.in_progress&&J())}catch(s){console.error("Error triggering update:",s)}}async function xt(){try{const{default:t}=await ct(async()=>{const{default:o}=await import("../chunks/0MHz4Was.js");return{default:o}},[],import.meta.url);(await t.fire({title:"Rollback to Previous Version?",html:`
					<div class="text-left">
						<p class="mb-4">This will rollback Xanthus to the previous version.</p>
						<div class="bg-red-50 border border-red-200 rounded-md p-3">
							<p class="text-sm text-red-800">
								<strong>Warning:</strong> The platform will restart during the rollback process.
							</p>
						</div>
						<p class="mt-3 text-sm text-gray-600">
							Only use this if you're experiencing issues with the current version.
						</p>
					</div>
				`,icon:"warning",showCancelButton:!0,confirmButtonText:"Rollback",cancelButtonText:"Cancel",confirmButtonColor:"#ef4444",showLoaderOnConfirm:!0,preConfirm:async()=>{try{return mt("Starting rollback...","Please wait while we rollback to the previous version"),await G.post("/version/rollback",{})}catch(o){t.showValidationMessage("Error: "+o.message)}finally{ft()}}})).isConfirmed&&(await t.fire({title:"Rollback Started!",text:"Xanthus is rolling back to the previous version. The platform will restart when complete.",icon:"success",confirmButtonColor:"#10b981"}),await D(),e(d)?.in_progress&&J())}catch(t){console.error("Error triggering rollback:",t)}}function _t(t){return new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}function X(t,s){const o=g=>g.replace(/^v/,"").split(".").map(Number),[u,n,p]=o(t),[f,v,_]=o(s);return u>f?!0:u<f?!1:n>v?!0:n<v?!1:p>_}function ht(t){return t.prerelease?"bg-yellow-100 text-yellow-800":e(l)&&X(t.tag_name,e(l).current)?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}function bt(t){return t.prerelease?"Pre-release":e(l)&&X(t.tag_name,e(l).current)?"Newer":e(l)&&t.tag_name===e(l).current?"Current":"Available"}function yt(t){return t<30?"bg-red-500":t<70?"bg-yellow-500":"bg-green-500"}Xt();var K=ee();Mt(t=>{Ut.title="Version Management - Xanthus"});var Q=i(a(K),2),wt=a(Q);st(wt,{variant:"primary",size:"sm",get disabled(){return e(b)},$$events:{click:Y},children:(t,s)=>{W();var o=at();V(()=>m(o,e(b)?"Refreshing...":"Refresh Versions")),c(t,o)},$$slots:{default:!0}}),r(Q);var it=i(Q,2);{var $t=t=>{var s=qt(),o=a(s);F(o,{children:(u,n)=>{var p=Ht(),f=a(p),v=i(a(f),2),_=a(v,!0);r(v),r(f);var g=i(f,2),h=a(g),w=a(h),A=a(w);r(w);var C=i(w,2),O=a(C);r(C),r(h);var B=i(h,2),N=a(B);r(B),r(g);var E=i(g,2),H=a(E,!0);r(E);var Z=i(E,2);{var tt=L=>{var I=Nt(),j=a(I),et=a(j,!0);r(j),r(I),V(()=>m(et,e(d).error)),c(L,I)};k(Z,L=>{e(d).error&&L(tt)})}r(p),V(L=>{m(_,e(d).status),m(A,`Updating to ${e(d).version??""}`),m(O,`${e(d).progress??""}%`),pt(N,1,`h-2 rounded-full transition-all duration-300 ${L??""}`),Ot(N,`width: ${e(d).progress??""}%`),m(H,e(d).message)},[()=>yt(e(d).progress)],U),c(u,p)},$$slots:{default:!0}}),r(s),c(t,s)};k(it,t=>{e(d)?.in_progress&&t($t)})}var ot=i(it,2);{var kt=t=>{var s=Ft(),o=a(s);F(o,{children:(u,n)=>{var p=Wt(),f=i(a(p),2),v=a(f),_=a(v),g=a(_,!0);r(_),W(2),r(v);var h=i(v,2),w=a(h);const A=U(()=>e(d)?.in_progress);st(w,{variant:"secondary",size:"sm",get disabled(){return e(A)},$$events:{click:xt},children:(C,O)=>{W();var B=at("Rollback");c(C,B)},$$slots:{default:!0}}),r(h),r(f),r(p),V(()=>m(g,e(l).current)),c(u,p)},$$slots:{default:!0}}),r(s),c(t,s)};k(ot,t=>{e(l)&&t(kt)})}var nt=i(ot,2);{var Ct=t=>{var s=Yt(),o=a(s);F(o,{children:(u,n)=>{var p=Gt(),f=a(p),v=i(a(f),2),_=i(a(v),2),g=a(_,!0);r(_),r(v),r(f),r(p),V(()=>m(g,e(y))),c(u,p)},$$slots:{default:!0}}),r(s),c(t,s)};k(nt,t=>{e(y)&&t(Ct)})}var lt=i(nt,2);{var Bt=t=>{var s=Jt();c(t,s)};k(lt,t=>{e(b)&&t(Bt)})}var dt=i(lt,2);{var Vt=t=>{var s=Zt(),o=i(a(s),2);zt(o,5,()=>e(l).available,At,(u,n)=>{F(u,{children:(p,f)=>{var v=Qt(),_=a(v),g=a(_),h=a(g),w=a(h),A=a(w,!0);r(w);var C=i(w,2),O=a(C,!0);r(C),r(h);var B=i(h,2),N=a(B,!0);r(B);var E=i(B,2),H=a(E),Z=a(H);r(H),r(E);var tt=i(E,2);{var L=$=>{var S=Kt(),M=a(S),rt=a(M,!0);r(M),r(S),V(()=>m(rt,e(n).body)),c($,S)};k(tt,$=>{e(n).body&&$(L)})}r(g);var I=i(g,2),j=a(I);{var et=$=>{const S=U(()=>X(e(n).tag_name,e(l).current)?"primary":"secondary"),M=U(()=>e(d)?.in_progress);st($,{get variant(){return e(S)},size:"sm",get disabled(){return e(M)},$$events:{click:()=>gt(e(n).tag_name)},children:(rt,re)=>{W();var vt=at();V(Lt=>m(vt,Lt),[()=>X(e(n).tag_name,e(l).current)?"Update":"Install"],U),c(rt,vt)},$$slots:{default:!0}})};k(j,$=>{e(n).tag_name!==e(l).current&&!e(n).draft&&$(et)})}var Et=i(j,2);r(I),r(_),r(v),V(($,S,M)=>{m(A,e(n).tag_name),pt(C,1,`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${$??""}`),m(O,S),m(N,e(n).name),m(Z,`Published: ${M??""}`),jt(Et,"href",e(n).html_url)},[()=>ht(e(n)),()=>bt(e(n)),()=>_t(e(n).published_at)],U),c(p,v)},$$slots:{default:!0}})}),r(o),r(s),c(t,s)};k(dt,t=>{!e(b)&&e(l)&&e(l).available.length>0&&t(Vt)})}var Pt=i(dt,2);{var Tt=t=>{var s=te();c(t,s)};k(Pt,t=>{!e(b)&&e(l)&&e(l).available.length===0&&!e(y)&&t(Tt)})}r(K),c(P,K),Rt()}export{me as component};
