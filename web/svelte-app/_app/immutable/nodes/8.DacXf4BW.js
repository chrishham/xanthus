import{p as e,o as t,l as r,a as s,i as a,f as o,h as n,e as l,g as i,s as d,$ as u,n as c,F as f,c as v,j as m,B as p,z as h,x as b,k as g,H as x,m as k,u as y,R as w,q as z,r as C,y as S,v as _,S as H,K as $,t as P,D as A,I,T as j,P as T,U as q,V as B}from"../chunks/D4QSdlkG.js";import{s as F}from"../chunks/Dp7Lw2XG.js";import{b as K}from"../chunks/DIuwMBRZ.js";import{B as M}from"../chunks/eOFwP-ou.js";import{C as X}from"../chunks/DKuP6dix.js";var D=o('<meta name="description" content="First-time setup for Xanthus K3s Deployment Tool"/>'),R=o('<div class="mb-3 p-3 bg-green-50 border border-green-200 rounded-md"><p class="text-sm text-green-800 font-medium">âœ“ API Key already configured</p> <p class="text-xs text-green-600 mt-1">You can continue with the current key or enter a new one below.</p></div>'),E=o('<p class="mt-1 text-sm text-red-600"> </p>'),L=o('<div class="mb-6"><div class="bg-blue-50 border border-blue-200 rounded-md p-4"><div class="flex"><div class="flex-shrink-0"><svg class="h-5 w-5 text-blue-400" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg></div> <div class="ml-3"><h3 class="text-sm font-medium text-blue-800">Hetzner API Key Required</h3> <div class="mt-2 text-sm text-blue-700"><p>We need your Hetzner Cloud API key to provision VPS instances for your K3s cluster.</p></div></div></div></div></div> <form class="space-y-4"><div><label for="hetzner_token" class="block text-sm font-medium text-gray-700 mb-2">Hetzner Cloud API Token</label> <!> <input type="password" id="hetzner_token"/> <p class="mt-1 text-xs text-gray-500">Need a token? <a href="https://console.hetzner.cloud/" target="_blank" class="text-blue-600 hover:underline">Create one in Hetzner Console</a></p> <!></div> <!></form>',1),N=o('<p class="mt-1 text-sm text-red-600"> </p>'),Y=o('<div class="mb-6"><div class="bg-blue-50 border border-blue-200 rounded-md p-4"><div class="flex"><div class="flex-shrink-0"><svg class="h-5 w-5 text-blue-400" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg></div> <div class="ml-3"><h3 class="text-sm font-medium text-blue-800">Cloudflare API Token Required</h3> <div class="mt-2 text-sm text-blue-700"><p>We need your Cloudflare API token for DNS management and SSL certificate provisioning.</p></div></div></div></div></div> <form class="space-y-4"><div><label for="cloudflare_token" class="block text-sm font-medium text-gray-700 mb-2">Cloudflare API Token</label> <input type="password" id="cloudflare_token" required placeholder="Enter your Cloudflare API token"/> <p class="mt-1 text-xs text-gray-500">Need a token? <a href="https://dash.cloudflare.com/profile/api-tokens" target="_blank" class="text-blue-600 hover:underline">Create one here</a></p> <!></div> <div class="flex space-x-3"><!> <!></div></form>',1),V=o('<div class="text-center"><div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 mb-4"><svg class="h-6 w-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></div> <h3 class="text-lg font-medium text-gray-900 mb-2">Setup Complete!</h3> <p class="text-sm text-gray-500 mb-6">Your Xanthus platform is now configured and ready to use.</p> <!></div>'),W=o('<div class="text-center mb-8"><img src="/static/icons/logo.png" alt="Xanthus Logo" class="w-20 h-20 mx-auto mb-4"/> <h1 class="text-3xl font-bold text-gray-900 mb-2">Xanthus Setup</h1> <p class="text-gray-600">First-time configuration</p></div> <div class="mb-6"><div class="flex items-center justify-between text-sm"><span class="text-blue-600 font-medium"> </span> <span class="text-gray-500"> </span></div> <div class="mt-2 w-full bg-gray-200 rounded-full h-2"><div class="bg-blue-600 h-2 rounded-full transition-all duration-300"></div></div></div> <!> <div class="mt-6 text-center"><p class="text-xs text-gray-500">Your API tokens are stored securely and used only for managing your cloud resources.</p></div>',1),G=o('<div class="min-h-screen bg-gray-100 flex items-center justify-center p-4"><!></div>');function U(o,U){e(U,!1);const[J,O]=d(),Q=()=>y(F,"$setupStore",J),Z=C();let ee=C(1),te=C(""),re=C(""),se=C(!1),ae=C({}),oe=C(null);async function ne(){z(se,!0),z(ae,{});try{if(!g(te).trim())return B(ae,g(ae).hetzner_token="Hetzner API token is required"),void z(se,!1);await F.configureHetzner(g(te))&&F.nextStep()}catch(e){console.error("Hetzner setup error:",e),B(ae,g(ae).hetzner_token=e.message||"Failed to configure Hetzner token")}finally{z(se,!1)}}async function le(){z(se,!0),z(ae,{});try{if(!g(re).trim())return B(ae,g(ae).cloudflare_token="Cloudflare API token is required"),void z(se,!1);await F.configureCloudflare(g(re))&&setTimeout(()=>{w("/app")},1500)}catch(e){console.error("Cloudflare setup error:",e),B(ae,g(ae).cloudflare_token=e.message||"Failed to configure Cloudflare token")}finally{z(se,!1)}}function ie(e){g(ae)[e]&&z(ae,{...g(ae),[e]:""})}function de(){return g(ee)/3*100+"%"}function ue(){switch(g(ee)){case 1:return"Hetzner Configuration";case 2:return"Cloudflare Configuration";case 3:return"Setup Complete";default:return"Setup"}}t(async()=>{if(y(K,"$authStore",J).isAuthenticated){const e=await F.checkSetupStatus();if(!e.isSetupRequired)return void w("/app");z(oe,e)}else z(oe,await F.checkSetupStatus())}),r(()=>Q(),()=>{z(Z,Q())}),r(()=>g(Z),()=>{z(ee,g(Z).step)}),s(),a();var ce=G();n(e=>{var t=D();u.title="Xanthus - Setup",l(e,t)});var fe=k(ce);X(fe,{class:"w-full max-w-md",children:(e,t)=>{var r=W(),s=c(f(r),2),a=k(s),o=k(a),n=k(o);S(o);var i=c(o,2),d=k(i,!0);S(i),S(a);var u=c(a,2),y=k(u);S(u),S(s);var C=c(s,2),B=e=>{var t=L(),r=c(f(t),2),s=k(r),a=c(k(s),2),o=e=>{var t=R();l(e,t)};v(a,e=>{g(oe),h(()=>g(oe)?.hasHetznerToken)&&e(o)});var n=c(a,2);let i;H(n);var d=c(n,4),u=e=>{var t=E(),r=k(t,!0);S(t),m(()=>b(r,(g(ae),h(()=>g(ae).hetzner_token)))),l(e,t)};v(d,e=>{g(ae),h(()=>g(ae).hetzner_token)&&e(u)}),S(s);var x=c(s,2);M(x,{type:"submit",get loading(){return g(se)},class:"w-full",variant:"primary",children:(e,t)=>{var r=$(),s=f(r),a=e=>{var t=P("Configuring Hetzner...");l(e,t)},o=(e,t)=>{var r=e=>{var t=P("Continue with Hetzner Setup");l(e,t)},s=e=>{var t=P("Configure Hetzner");l(e,t)};v(e,e=>{g(oe),h(()=>g(oe)?.hasHetznerToken)?e(r):e(s,!1)},t)};v(s,e=>{g(se)?e(a):e(o,!1)}),l(e,r)},$$slots:{default:!0}}),S(r),m(e=>{n.disabled=g(se),n.required=(g(oe),h(()=>!g(oe)?.hasHetznerToken)),i=A(n,1,"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-50 disabled:cursor-not-allowed svelte-m3w360",null,i,e),I(n,"placeholder",(g(oe),h(()=>g(oe)?.hasHetznerToken?"Enter new Hetzner API token":"Enter your Hetzner API token")))},[()=>({"border-red-300":g(ae).hetzner_token,"focus:ring-red-500":g(ae).hetzner_token,"focus:border-red-500":g(ae).hetzner_token})],p),j(n,()=>g(te),e=>z(te,e)),T("input",n,()=>ie("hetzner_token")),T("submit",r,q(ne)),l(e,t)},K=(e,t)=>{var r=e=>{var t=Y(),r=c(f(t),2),s=k(r),a=c(k(s),2);let o;H(a);var n=c(a,4),i=e=>{var t=N(),r=k(t,!0);S(t),m(()=>b(r,(g(ae),h(()=>g(ae).cloudflare_token)))),l(e,t)};v(n,e=>{g(ae),h(()=>g(ae).cloudflare_token)&&e(i)}),S(s);var d=c(s,2),u=k(d);M(u,{type:"button",get disabled(){return g(se)},class:"flex-1",variant:"secondary",$$events:{click:()=>F.previousStep()},children:(e,t)=>{_();var r=P("Back");l(e,r)},$$slots:{default:!0}});var x=c(u,2);M(x,{type:"submit",get loading(){return g(se)},class:"flex-1",variant:"primary",children:(e,t)=>{var r=$(),s=f(r),a=e=>{var t=P("Completing Setup...");l(e,t)},o=e=>{var t=P("Complete Setup");l(e,t)};v(s,e=>{g(se)?e(a):e(o,!1)}),l(e,r)},$$slots:{default:!0}}),S(d),S(r),m(e=>{a.disabled=g(se),o=A(a,1,"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-50 disabled:cursor-not-allowed svelte-m3w360",null,o,e)},[()=>({"border-red-300":g(ae).cloudflare_token,"focus:ring-red-500":g(ae).cloudflare_token,"focus:border-red-500":g(ae).cloudflare_token})],p),j(a,()=>g(re),e=>z(re,e)),T("input",a,()=>ie("cloudflare_token")),T("submit",r,q(le)),l(e,t)},s=(e,t)=>{var r=e=>{var t=V(),r=c(k(t),6);M(r,{class:"w-full",variant:"primary",$$events:{click:()=>w("/app")},children:(e,t)=>{_();var r=P("Go to Dashboard");l(e,r)},$$slots:{default:!0}}),S(t),l(e,t)};v(e,e=>{3===g(ee)&&e(r)},t)};v(e,e=>{2===g(ee)?e(r):e(s,!1)},t)};v(C,e=>{1===g(ee)?e(B):e(K,!1)}),_(2),m((e,t)=>{b(n,`Step ${g(ee)??""} of 3`),b(d,e),x(y,`width: ${t??""}`)},[()=>h(ue),()=>h(de)],p),l(e,r)},$$slots:{default:!0}}),S(ce),l(o,ce),i(),O()}export{U as component};
