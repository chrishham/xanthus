var t=Object.defineProperty,s=(s,e,n)=>((s,e,n)=>e in s?t(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n)(s,"symbol"!=typeof e?e+"":e,n);import{d as e,w as n}from"./Dr171qo1.js";const a=n({applications:[],predefinedApps:[],loading:!1,autoRefresh:{enabled:!0,interval:3e4,countdown:0,isRefreshing:!1},modals:{deployment:{show:!1,predefinedApp:null,domains:[],servers:[]},password:{show:!1,app:null,mode:"view"},portForwarding:{show:!1,app:null,domain:"",ports:[],newPort:{port:"",subdomain:""}}}}),o=e(a,t=>t.applications),l=e(a,t=>t.predefinedApps);e(a,t=>t.autoRefresh);const i=t=>{a.update(s=>({...s,autoRefresh:{...s.autoRefresh,enabled:t}}))},d=t=>{a.update(s=>({...s,autoRefresh:{...s.autoRefresh,countdown:t}}))},r=(t,s,e)=>{a.update(n=>({...n,modals:{...n.modals,deployment:{show:!0,predefinedApp:t,domains:s,servers:e}}}))},h=()=>{a.update(t=>({...t,modals:{...t.modals,deployment:{...t.modals.deployment,show:!1}}}))},u=(t,s="view")=>{a.update(e=>({...e,modals:{...e.modals,password:{show:!0,app:t,mode:s}}}))},p=()=>{a.update(t=>({...t,modals:{...t.modals,password:{...t.modals.password,show:!1}}}))};const c=new class{constructor(){s(this,"intervalId",null),s(this,"countdownId",null),s(this,"refreshCallback",null),s(this,"interval",3e4),this.setupVisibilityHandling()}start(t,s=3e4){this.refreshCallback=t,this.interval=s,this.stop(),this.startCountdown(),this.intervalId=window.setInterval(async()=>{!document.hidden&&this.refreshCallback&&(await this.refreshCallback(),this.startCountdown())},this.interval)}stop(){null!==this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null),null!==this.countdownId&&(clearInterval(this.countdownId),this.countdownId=null),d(0)}startCountdown(){null!==this.countdownId&&clearInterval(this.countdownId);let t=Math.floor(this.interval/1e3);d(t),this.countdownId=window.setInterval(()=>{t--,d(t),t<=0&&null!==this.countdownId&&(clearInterval(this.countdownId),this.countdownId=null)},1e3)}setupVisibilityHandling(){document.addEventListener("visibilitychange",()=>{document.hidden?this.stop():this.refreshCallback&&(this.start(this.refreshCallback,this.interval),this.refreshCallback())})}isRunning(){return null!==this.intervalId}};export{a,p as b,c,o as d,r as e,u as f,h,l as p,i as s};
